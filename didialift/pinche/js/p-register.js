dd.ready(function(){function e(){var e=document.getElementById("carnoSelect");ulEl=e.getElementsByClassName("options")[0];var t=function(){i.ajax({method:"POST",url:"/pinche/cartype/getlicensehead",succFunc:function(t){var n=i.txtToJson(t);if("0"==n.errno){for(var a=n.data,r=n.sort,c="",o=0,s=r.length;s>o;o++)c+='<li data-id="'+r[o]+'" data-show="'+a[r[o]]+'">'+a[r[o]]+"</li>";ulEl.innerHTML+=c,slideSelect_carno(txt_carOne,e,[])}},failFunc:function(){}})};t()}function t(){var e=function(e,t){o[e]=t,localStorage.driver_form=JSON.stringify(o)};txt_realname.addEventListener("change",function(){e("txt_realname",this.value)},!1),txt_licence.addEventListener("change",function(){e("txt_licence",this.value)},!1),txt_carower.addEventListener("change",function(){e("txt_carower",this.value)},!1),txt_carOne2.addEventListener("change",function(){e("txt_carOne2",this.value)},!1),o&&(txt_realname.value=o.txt_realname||"",txt_licence.value=o.txt_licence||"",txt_carower.value=o.txt_carower||"",txt_carOne2.value=o.txt_carOne2||"")}function n(){txt_realname.addEventListener("focus",function(){this.className=""},!1),txt_realname.addEventListener("blur",function(){s.is_Chinese_name(this.value)||(this.className="error")},!1),txt_licence.addEventListener("focus",function(){this.className=""},!1),txt_licence.addEventListener("blur",function(){s.is_ID_card(this.value)||(this.className="error")},!1),txt_carower.addEventListener("focus",function(){this.className=""},!1),txt_carower.addEventListener("blur",function(){s.is_Chinese_name(this.value)||(this.className="error")},!1),txt_carOne2.addEventListener("focus",function(){this.className=""},!1),txt_carOne2.addEventListener("blur",function(){s.is_carNo(this.value)||(this.className="error")},!1)}function a(e){var t=function(e,t){c.alert({title:"",tip:t,btn:{handler:function(){e.focus()}}})};return s.is_Chinese_name(e.drive_license_name)?s.is_ID_card(e.drive_license_number)?s.is_Chinese_name(e.travel_license_name)?""==txt_carOne.value?(c.alert("请选择车牌归属地"),!1):s.is_carNo(e.car_license_number)?!0:(t(txt_carOne2,"车牌号填写错误"),!1):(t(txt_carower,"行驶证姓名填写错误"),!1):(t(txt_licence,"身份证号填写错误"),!1):(t(txt_realname,"请填写真实姓名"),!1)}function r(e){c.loading("正在请求，请稍后~"),i.ajax({method:"POST",url:pageParams.submit_url,data:e,succFunc:function(e){var t=i.txtToJson(e);"0"==t.errno?(localStorage.removeItem("driver_form"),location.replace(t.url)):"3002"==t.errno?(localStorage.removeItem("driver_form"),location.replace(t.url)):c.alert(t.errmsg)},failFunc:function(){c.alert("网络有点不给力，请稍后再试哦~")}})}var i=dd.base,c=dd.dialog,o=i.txtToJson(localStorage.driver_form||{}),s={is_Chinese_name:function(e){var t=/^[\u4E00-\u9FA5]{2,}$/;return t.test(e)?!0:!1},is_ID_card:function(e){var t=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;return t.test(e)===!1?!1:!0},is_carNo:function(e){var t=/^[A-Za-z]{1}[A-Za-z0-9]{5}$/;return t.test(e)?!0:!1}};!function(){e(page_driver.car_province_id),"join"==pageParams.type&&t(),n(),i.touch(btnSubmit,function(){if("btn-gray"!=btnSubmit.className){for(var e=document.getElementsByTagName("input"),t=0,n=e.length;n>t;t++){var i=e[t];i.setAttribute("readOnly","true"),i.blur()}scrollTo(0,0),setTimeout(function(){for(t=0,n=e.length;n>t;t++){var a=e[t];a.removeAttribute("readOnly")}},100);var c={drive_license_name:txt_realname.value,drive_license_number:txt_licence.value.toLocaleUpperCase(),travel_license_name:txt_carower.value,car_province_id:txt_carOne.getAttribute("data-id"),car_license_number:txt_carOne2.value.toLocaleUpperCase(),phone_number:pageParams.phone||"",token:pageParams.token||"",sign:pageParams.sign||""},o=a(c);o&&r(c)}})}()});