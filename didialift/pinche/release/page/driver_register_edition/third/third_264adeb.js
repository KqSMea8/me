define("page/driver_register_edition/third/third.js",function(a,e){function t(){function a(a){var i=t.txtToJson(a),n=txt_carone.getAttribute("name"),o=pageParams.filed_list[n].value||g.get(n)||"1",l=i.data[o];if(txt_carone.value=l||g.get(n+"_zh"),"0"==i.errno){for(var u=i.data,s=i.sort,f="",_=0,p=s.length;p>_;_++)f+='<li data-id="'+s[_]+'" data-show="'+u[s[_]]+'">'+u[s[_]]+"</li>";if(ulEl.innerHTML+=f,c(),!r(txt_carone))return void txt_carone.setAttribute("disabled","");d(txt_carone,e,[])}}var e=document.getElementById("carnoSelect"),t=dd.base;ulEl=e.getElementsByClassName("options")[0];var i=function(){t.ajax({method:"POST",url:"/pinche/cartype/getlicensehead",succFunc:a,failFunc:function(){}})};i()}function r(a){return"string"!=typeof a&&(a=a.getAttribute("name")),1==pageParams.filed_list[a].changeable}function i(a){return"string"!=typeof a&&(a=a.getAttribute("name")),3==pageParams.filed_list[a].verify}function n(){i("carcardnumber")&&r("carcardnumber")&&_.addClass("verify_failed");var n=_.find("#car_type");m.forEach(function(a){n.attr("data-"+a,pageParams.filed_list[a].value||g.get(a))}),n.val(pageParams.filed_list[m[0]].zhvalue+pageParams.filed_list[m[1]].zhvalue+pageParams.filed_list[m[2]].zhvalue||g.get(m[0]+"_zh"));var d=_.find("#txt_carnumber"),u=d.attr("name");d.val(pageParams.filed_list[u].value||g.get(u)).attr("disabled",r(u)?null:"");var f=_.find("#txt_carone");u=f.attr("name"),f.attr("data-id",pageParams.filed_list[u].value||g.get(u)||"1"),t();var p=car_type.getAttribute("name").split(",")[0];if(r(p)===!1)car_type.setAttribute("disabled","");else{var v=_.find("#car_type").on("click",function(e){function t(a){r.value=a.carInfo;$.each(a.value,function(e,t){var i;switch(e){case"color":i=m[2];break;case"brand":i=m[0];break;case"type":i=m[1]}r.setAttribute("data-"+i,t.id),g.save_cache(i,t.id),g.save_cache(i+"_zh",a.carInfo),c()})}var r=this;e.preventDefault(),e.stopPropagation(),a("carchoose/main.js"),$.didiCarChoose({brandsURL:pageParams.getcarbrand,typesURL:pageParams.getcartype,colorsURL:pageParams.getcolor,onselect:t})});v.on("focus",function(){v.blur()})}_.find(".next_btn").on("click",function(){function a(a){var e=i.txtToJson(a);if("102"==e.errno)location.replace(pageParams.gologinurl);else if("0"==e.errno)g.clean(),o();else{if("3002"!=e.errno)return e.errno in c?void r.confirm({title:c[e.errno].title,text:c[e.errno].text,confirm:{val:c[e.errno].confirm_val,handler:function(){location.href=c[e.errno].confirm_url}}}):r.alert(e.errmsg);g.clean(),o()}s.closeLoading()}var t=e.check_filed();if(0!=t){var r=dd.dialog,i=dd.base,n="车牌：{carbrand} 已注册，请确认车牌是否正确。如仍需注册该车牌，请申诉。";n=n.replace(/\{carbrand\}/,$("#txt_carone").val()+t.carcardnumber);var c={6010:{title:"",text:"该身份证已被注册，如果仍需注册，请进行申诉。",confirm_val:"我要申诉",handler_url:"http://static.xiaojukeji.com/didialift/hybrid/pages/help/help-accountDatumOQ06.html"},6009:{title:"",text:n,confirm_val:"我要申诉",confirm_url:"http://static.xiaojukeji.com/didialift/hybrid/pages/help/help-accountDatumOQ07.html"}};s.showLoading(),$.ajax({type:"GET",url:pageParams.reg_url,data:$.extend({step:3,commit:1,token:pageParams.upload_data.token},t),success:a,error:function(){r.alert("网络有点不给力，请稍后再试哦~")}}),$.ajax({method:"GET",dataType:"jsonp",url:pageParams.inviteurl,data:{plate:txt_carone.value+t.carcardnumber}})}}),_.find(".previous_btn").on("click",function(){l()}),_.find("#txt_carone").on("change",function(){g.save_cache(this.getAttribute("name"),this.getAttribute("data-id")),g.save_cache(this.getAttribute("name")+"_zh",this.value)}),_.find("#txt_carnumber").on("blur",function(){s.regular.is_carNo(this.value)===!1?(s.warning("请填写正确的"+this.getAttribute("placeholder")),s.warning_text(_.find("#txt_carnumber"))):g.save_cache(this.name,this.value),c()},!1),_.one("touchstart",function(){_.removeClass("verify_failed")})}function c(){for(var a=0;a<v.length;a++)if(r(v[a].getAttribute("name").split(",")[0])!==!1&&0==("string"==typeof h[a]?v[a].getAttribute(h[a]):h[a]()))return void _.trigger("is_full_fill",!1);_.trigger("is_full_fill",!0)}var o,l,d=a("page/driver_register_edition/third/select.js"),u=!1,s=a("page/driver_register_edition/tool.js"),f=dd.dialog,g=s.localCache.instance("driver_register_third"),_=e.$container=$(".form_third");e.wakeup=function(a,e,t){o=function(){s.warning.close(),e()},l=function(){s.warning.close(),t()},u===!1&&(u=!0,n(),c())};var p={carprovinceid:"车省号",carcardnumber:"车牌号",carbrandid:"品牌号",cartypeid:"车型号",carcolorid:"车颜色"},m=["carbrandid","cartypeid","carcolorid"];e.check_filed=function(){var a=_.find("#car_type"),e={carprovinceid:_.find("#txt_carone"),carcardnumber:_.find("#txt_carnumber"),carbrandid:a,cartypeid:a,carcolorid:a},t={carprovinceid:e.carprovinceid.attr("data-id"),carcardnumber:e.carcardnumber.val(),carbrandid:a.attr("data-carbrandid"),cartypeid:a.attr("data-cartypeid"),carcolorid:a.attr("data-carcolorid")};for(var i in t)if(r(e[i][0].getAttribute("name").split(",")[0])!==!1){if("carcardnumber"==i){if(s.regular.is_carNo(t[i])===!1)return f.alert("请填写正确"+p[i]||""),!1}else if(0==t[i])return f.alert("请填写正确"+p[i]||""),!1}else delete t[i];return t};var v=[txt_carone,txt_carnumber,car_type],h=["data-id",function(){return s.regular.is_carNo(txt_carnumber.value)},"data-carbrandid"]});