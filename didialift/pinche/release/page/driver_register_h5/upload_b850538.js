define("page/driver_register_h5/upload.js",function(t,n,i){var o=i.exports=function(e,t){var n="iframepost"+Math.floor(1e3*Math.random()),i=t.filekey||"file";this.opt=t,this.$el=$(e),this.fileInput=document.createElement("INPUT"),this.form=document.createElement("FORM"),this.iframe=document.createElement("IFRAME"),this.fileInput.name=i,this.fileInput.type="file",this.fileInput.style.cssText="position: absolute;left:0;top:0;height:100%;width:100%",this.form.target=n,this.form.method="POST",this.form.encoding="multipart/form-data",this.form.action=t.url,this.iframe.style.display="none",this.iframe.name=n,this.form.appendChild(this.fileInput),e.appendChild(this.form),document.body.appendChild(this.iframe),this.register()};o.prototype={register:function(){var e=this;this.fileInput.addEventListener("change",function(t){e.onChange(t)},!1),this.iframe.addEventListener("load",function(){e.onsuccess(this.contentWindow.document.body.innerHTML)},!1)},onChange:function(e){{var t=this,n=e.target.files[0];e.target.value.match(/\.(png|jpg|jpeg|gif)$/)[1]}canvasResize(n,{width:500,height:500,crop:!1,quality:80,rotate:0,callback:function(n,i,o){var a=new Image;a.onload=function(){$(this).css({margin:"10px auto",width:i,height:o}).appendTo(t.$el)},t.ext=e.target.value.match(/\.(png|jpg|jpeg|gif)$/)[1],t.clip(n)}})},clip:function(e){new a({width:500,height:500,rawData:e,onSave:function(e){me.upload(e)}})},upload:function(t){var n=this,i=new FormData,o=canvasResize("dataURLtoBlob",t);o.name=file.name,i.append(e.target.getAttribute("name"),o),i.append("ext",n.ext);var a=new XMLHttpRequest;a.open("POST",n.opt.url,!0),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("pragma","no-cache"),a.upload.addEventListener("progress",function(e){if(e.lengthComputable){var t=Math.ceil(e.loaded/e.total*100);console.log(t)}},!1),a.addEventListener("load",function(e){var t=JSON.parse(e.target.responseText);console.log("done",t),n.onsuccess(t)},!1),a.send(i)},onsuccess:function(e){this.opt.onSuccess&&this.opt.onSuccess(e)}};var a=function(t){var n=t.rawData,i=t.onSave;this.rawData=n,this.onSave=i;var o=this.setup(n);this.pinchZoom=new RTP.PinchZoom(o,{}),this.pinchZoom.on("pz_dragstart",function(e){console.log(e.type,e)}),this.pinchZoom.on("pz_dragend",function(){console.log(e.type,e)})},r=function(e,t){var n=document.createElement(t||"DIV");return n.style.cssText=e.join(";"),n};a.prototype={setup:function(e){function t(){h.style.width=n.style.width=innerWidth+"px",h.style.lineHeight=h.style.height=n.style.height=innerHeight+"px";var e=innerWidth/innerHeight,t=1>e?innerWidth:innerHeight;o.style[1>e?"height":"width"]=i.style[1>e?"height":"width"]=a.style[1>e?"top":"left"]=(1>e?innerHeight-t:innerWidth-t)/2+"px",a.style[1>e?"left":"top"]="0",s.style[1>e?"width":"height"]="100%",s.style[1>e?"height":"width"]="auto",i.style[1>e?"top":"left"]="0",o.style[1>e?"bottom":"right"]="0",o.style.left=1>e?"0":"auto",i.style[1>e?"left":"top"]=o.style[1>e?"left":"top"]="0",o.style.top=1>e?"auto":"0",o.style[1>e?"width":"height"]=i.style[1>e?"width":"height"]=t+"px"}window.addEventListener("resize",t,!1);var n=r(["position: absolute","background-color: rgba(0,0,0,1)","left:0","top:0","z-index: 99999","overflow: hidden"]);n.id="container"+~~(1e6*Math.random()),n.addEventListener("touchmove",function(e){e.preventDefault(),e.stopPropagation()});var i=r(["position: absolute","z-index: 1","background-color: rgba(0,0,0,.5)","pointer-events: none"]);i.id="maskTop"+~~(1e6*Math.random());var o=r(["position: absolute","z-index: 1","background-color: rgba(0,0,0,.5)","pointer-events: none"]);o.id="maskbottom"+~~(1e6*Math.random());var a=r(["position: absolute","z-index: 1","box-sizing: border-box","-webkit-box-sizing: border-box","width: "+Math.min(innerWidth,innerHeight)+"px","height: "+Math.min(innerWidth,innerHeight)+"px","border: 1px solid #fff","background-color: transparent","pointer-events: none"]);a.id="viewport"+~~(1e6*Math.random());var s=r(["-webkit-user-drag: none","z-index: 0","  -webkit-tap-highlight-color: rgba(0,0,0,0)","vertical-align: middle"],"IMG");s.id="photo"+~~(1e6*Math.random());var h=r(["-webkit-user-drag: none","position: absolute","text-align: center","z-index: 0"]);return h.id="photoFrame"+~~(1e6*Math.random()),s.src=e,t(),h.appendChild(s),n.appendChild(i),n.appendChild(o),n.appendChild(a),n.appendChild(h),document.body.appendChild(n),h}}});