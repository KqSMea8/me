define("page/driver_register_saver_index/main.js",function(a){function e(){var a=pageParams.form_data;for(var e in a)a[e]=a[e]||g.get(e)||"";var r=[a.carbrandid.zhvalue,a.cartypeid.zhvalue,a.carcolorid.zhvalue],o=$("#carbrand");o.val($.trim(r.join(" "))).data("carbrandid",a.carbrandid.value).data("cartypeid",a.cartypeid.value).data("carcolorid",a.carcolorid.value),1!=a.carbrandid.changeable?o.attr("readonly","").parent().parent().addClass("disabled"):n(),1!=a.carprovinceid.changeable?$("#carprovince").attr("disabled","").parent().parent().addClass("disabled"):i(),$("#carno").val(a.carno.value),1!=a.carno.changeable&&$("#carno").attr("disabled","").parent().parent().addClass("disabled"),$("#drivelicensename").val(a.drivelicensename.value),1!=a.drivelicensename.changeable&&$("#drivelicensename").attr("disabled","").parent().parent().addClass("disabled"),$("#drivelicensenumber").val(a.drivelicensenumber.value),1!=a.drivelicensenumber.changeable&&$("#drivelicensenumber").attr("disabled","").parent().parent().addClass("disabled")}function r(a,e,r){var n=m();n&&(r&&(n.token=r),t.showLoading(),$.ajax({url:a,data:n,success:function(a){t.closeLoading(),a=JSON.parse(a),0==a.errno?location.assign(e):101==a.errno?v():o.dialog.alert(a.errmsg)}}))}function n(){$("#carbrand").click(function(){u.log("cartype"),$.didiCarChoose({brandsURL:pageParams.getcarbrand,typesURL:pageParams.getcartype,colorsURL:pageParams.getcolor,onselect:function(a){$("#carbrand").val(a.carInfo).data("carbrandid",a.value.brand.id).data("cartypeid",a.value.type.id).data("carcolorid",a.value.color.id)}})})}function i(){function a(a){var n=r.txtToJson(a);console.log(n);var i=0==pageParams.form_data.carprovinceid.value?1:pageParams.form_data.carprovinceid.value;if($("#carprovince").val(n.data[i]),"0"==n.errno){for(var o=n.data,c=n.sort,d="",t=0,s=c.length;s>t;t++)d+='<li data-id="'+c[t]+'" data-show="'+o[c[t]]+'">'+o[c[t]]+"</li>";ulEl.innerHTML+=d}l(carprovince,e,[],function(a){$("#carprovince").data("id",a.value),$("#carprovince").val(a.text)})}var e=document.getElementById("carnoSelect"),r=o.base;ulEl=e.getElementsByClassName("options")[0];var n=function(){r.ajax({method:"POST",url:"/pinche/cartype/getlicensehead",succFunc:a,failFunc:function(){}})};n()}a("carchoose");var o=a("dd"),c=a("log"),l=a("SingleSelector"),d=a("tool"),t=a("driver_register_tool"),s=a("login");c.saverindex_page_sw();var u=function(){var a=[];return{log:function(e){for(var r=0;r<a.length;r++)if(a[r]==e)return;a.push(e),c["saverform_inputbox_focus_"+e]()}}}(),v=function(){s.show().sendmsm(function(a,e){t.showLoading(),$.ajax({url:pageParams.p_getsmscode_url+a,timeout:"5000",success:function(a){t.closeLoading();var a=JSON.parse(a);alert(a.ret),console.log(a),0==a.errno?e.focus():1008==a.errno?(o.dialog.alert("您将来接到电话通知您验证码，请注意查收"),e.focus()):(btnCheck.removeClass("btnGray"),phone.disabled="false",o.dialog.alert(a.errmsg))},error:function(){t.closeLoading(),o.dialog.alert("网络请求失败，请稍后重试"),phone.disabled="false",_this.removeClass("btnGray")}})}).commit(function(a,e){$.ajax({type:"POST",url:pageParams.p_login_url,data:{phone:a,code:e},timeout:"5000",success:function(a){var a=JSON.parse(a);if(console.log(a),0==a.errno)window.location.href=pageParams.success_url;else if(101==a.errno){s.hide();var e=a.commit_url,n=a.next_url,i=a.token;r(e,n,i),pageParams.commit_url=e,pageParams.token=i}else 102==a.errno?location.href=a.next_url:alert(a.errmsg)},error:function(){_this.removeClass("btnGray")}})})},g=d.localCache.instance("driver_register_saver_form");e();var m=function(){var a={carbrandid:$("#carbrand").data("carbrandid"),cartypeid:$("#carbrand").data("cartypeid"),carcolorid:$("#carbrand").data("carcolorid"),carprovinceid:$("#carprovince").data("id"),carcardnumber:$("#carno").val(),drivelicensename:$("#drivelicensename").val(),drivelicensenumber:$("#drivelicensenumber").val()};return""==a.carbrandid?(o.dialog.alert("请选择品牌和车型"),!1):t.regular.is_carNo(a.carcardnumber)?t.regular.is_Chinese_name(a.drivelicensename)?t.regular.is_ID_card(a.drivelicensenumber)?a:(o.dialog.alert("请输入正确的驾驶证号"),!1):(o.dialog.alert("请输入正确的驾驶人姓名"),!1):(o.dialog.alert("请输入正确的车牌号"),!1)};$("#submit").click(function(){var a=pageParams.commit_url,e=pageParams.success_url,n=pageParams.token,i=""!=pageParams.token;if(i)r(a,e,n);else{var o=m();if(!o)return;v()}}),$("#carno").on("blur",function(){$("#carno").val($("#carno").val().toUpperCase())},!1)});