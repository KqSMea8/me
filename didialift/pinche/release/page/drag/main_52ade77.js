define("page/drag/main.js",function(t){t("dd");var o=t("page/drag/vars.js");$(function(){var t={param:{$friendsTopWrap:null,$friendsBottomWrap:null,isTouch:!0,isMoveFlag:!0,isLock:!1,isDragFlag:!1},model:{$dragTarget:null,beginLeft:0,beginTop:0,startX:0,startY:0,moveX:0,moveY:0,distX:0,distY:0,isVerIn:!1,isHorIn:!1,topHeadTop:0},view:{},ctrl:{}},i=t.param,e=t.model,s=(t.view,t.ctrl);i.init=function(){return i.isTouch="ontouchstart"in window,i.$friendsBottomWrap=$(".friends_bottom_wrap"),i.$friendsBottomWrap.length>0?(i.$friendsTopWrap=$(".friends_top_wrap"),i.$headItems=i.$friendsTopWrap.find("span"),i.topHeadTop=i.$headItems.position().top,i.isTouch||i.$friendsBottomWrap.find("span").addClass("move"),!0):!1},s.int=function(){i.init()&&s.eventInit()},s.getItemWidth=function(t){return t.width()},s.eventInit=function(){var t=s.process;i.$friendsBottomWrap.on(o.START_EVENT,".bottom_head",function(o){i.isLock||(i.$dragTarget=$(this),t.touchStart.call($(this),o),i.isDragFlag=!0)}),$(document).on(o.MOVE_EVENT,function(o){i.isLock||t.touchMove.call(i.$dragTarget,o)}),$(document).on(o.END_EVENT,function(o){return i.isDragFlag?(t.touchEnd.call(i.$dragTarget,o),!1):void 0})},s.process={},s.process.touchStart=function(t){e.startX=i.isTouch?t.touches[0].pageX:t.clientX,e.startY=i.isTouch?t.touches[0].pageY:t.clientY,e.beginLeft=this.position().left,e.beginTop=this.position().top},s.process.touchMove=function(t){if(i.isDragFlag){var o=i.isTouch?t.touches[0].pageX:t.clientX,s=i.isTouch?t.touches[0].pageY:t.clientY,n=o-e.startX+e.beginLeft,a=s-e.startY+e.beginTop;n=0>n?0:n,a=0>a?0:a;var r=i.$friendsBottomWrap.width()-this.width(),d=i.$friendsBottomWrap.height()-this.height();n=n>r?r:n,a=a>d?d:a,this.css({left:n,top:a}),e.moveX=o,e.distX=n,e.distY=a,t.preventDefault(),t.stopPropagation()}},s.process.touchEnd=function(t){if(i.isTouch||(e.moveX=t.clientX),i.isDragFlag&&(i.isDragFlag=!1),!(i.isTouch&&0==e.moveX||!i.isTouch&&e.startX==e.moveX)){if(e.distY+this.height()>i.topHeadTop&&e.distY<i.topHeadTop+i.$headItems.height()?(i.isVerIn=!0,console.log("isVerIn")):i.isVerIn=!1,i.isVerIn){var o=0;i.$headItems.removeClass("cur"),i.$headItems.each(function(t,s){return o=$(s).position().left+$(s).width(),e.distX<o?(console.log(t),$(s).addClass("cur"),i.isHorIn=!0,!1):void(i.isHorIn=!1)}),i.isHorIn||i.$headItems.removeClass("cur")}else i.$headItems.removeClass("cur");e.startX=0,e.startY=0,e.distX=0,e.distY=0,e.moveX=0,i.isDragFlag=!1,i.$dragTarget=null}},s.int()})});