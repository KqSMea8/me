define("page/valid/main.js",function(e){window.dd=e("dd");var n=e("tool"),a=e("ddbridge"),t=e("log");t.showLoginPage();var r=function(){var e=n.getQueryParams();return"token"in e?!0:(a.getToken(function(n){e.token=n;var a="?";for(var t in e)"?"!=a&&(a+="&"),a+=t+"="+e[t];location.search=a}),!1)};dd.ready(function(){r();var e=document,n=dd.base,a=dd.dialog,t=e.getElementById("openid").value,l=e.getElementById("p_getsmscode_url").value,o=e.getElementById("p_login_url").value,u=e.getElementById("type").value,c=e.getElementById("channel").value,i=e.getElementById("phone"),s=e.getElementById("code"),d=e.getElementById("btnSubmit"),g=e.getElementById("btnCheck"),f=60,m=function(e){return/^1[3|4|5|8|7][0-9]\d{8}$/.test(e)?!0:!1};i.addEventListener("input",function(e){var n=i;n.value=n.value.replace(/[^\d]/g,"").slice(0,11),g.className=m(n.value)?"btn-orange fr":"btn-gray fr",v(e)},!1),s.addEventListener("input",function(e){v(e)},!1);var v=function(){var e=s;e.value=e.value.replace(/[^\d]/g,"").slice(0,4),d.className=4==e.value.length&&m(i.value)?"btn-orange":"btn-gray"};n.touch(g,function(){function e(){return 0==f?(g.className="btn-orange fr",g.innerHTML="验证","btn-orange"==d.className,"change"!==u&&(i.disabled=""),void(f=60)):("btn-gray"==d.className,g.className="btn-gray fr",g.innerHTML=f+"s",f--,void setTimeout(function(){e()},1e3))}"btn-gray fr"!=g.className&&(i.disabled="true",g.className="btn-gray fr",e(),n.ajax({method:"GET",url:l+i.value,succFunc:function(e){var t=n.txtToJson(e);0==t.errno?s.focus():1008==t.errno?(a.alert("您将来接到电话通知您验证码，请注意查收"),s.focus()):(g.className="btn-orange fr",i.disabled="false",a.alert(t.errmsg))},failFunc:function(){g.className="btn-orange fr",a.alert("网络请求失败，请稍后重试"),i.disabled="false"}}))}),n.touch(d,function(){if("btn-gray"!=d.className){d.className="btn-gray",s.readOnly="readOnly",s.blur(),setTimeout(function(){s.readOnly="",s.blur()},100);var e=""==c?"":"&channel="+c,r=regfrom_input.value.trim();e+=r?"&regfrom="+r:"",n.ajax({method:"POST",url:o+"&phone="+i.value+e,data:{lat:"116.30786072065",lng:"40.045781758746",channel:c,regfrom:r,phone:i.value,code:s.value,openid:t},succFunc:function(e){var t=n.txtToJson(e);0==t.errno?location.replace(t.next_url):9999==t.errno?location.replace(t.url):a.alert(t.errmsg)},failFunc:function(){a.alert("网络请求失败，请稍后重试")}})}}),function(){11==i.value.length&&(g.className="btn-orange fr"),setTimeout(function(){i.focus()},100)}()})});