define("didi-component-ddplayer/player/ctrlProgress.js",function(e){"use strict";var t=e("didi-component-ddplayer/player/mediaPlayer.js"),r=e("didi-component-ddplayer/base/vars.js"),a=e("didi-component-ddplayer/player/playHistory.js"),i=e("didi-component-ddplayer/base/console.js"),o=(e("didi-component-ddplayer/player/errorTypes.js"),function(e){var t=e.cache,r=t.srcList[t.modeType]||[];if(r.length>1){var a=e.videoTag.currentTime,i=t.curIndex;return $.each(r,function(e,t){return i>e?void(a+=t.duration||0):!1}),a}return e.videoTag.currentTime}),n=function(e){{var t=e.videoData;e.cache}if(0!==e.currentTime&&!e._makeHistoryFlag){var r={sid:t.sid,vid:t.vid,site:t.site,cid:t.cid,playTime:e.currentTime,duration:t.totalDuration,title:t.tvname||""};a.setHistory(r),e._makeHistoryFlag=!0,setTimeout(function(){e._makeHistoryFlag=!1},1e3)}},d=function(e){var t=e.videoData;if(e.cache.isRemHistory){var r={vid:t.vid,site:t.site},o=a.getHistory(r),n=null;o.length>0&&(n=o[0],i.log("prgress:",n.playTime),e.seekTo(n.playTime)),e._playByHistoryFlag=!0}},s=function(e){e._addEvent("timeupdate",function(){e._sendVVFlag||(e._sendVVFlag=!0),!ddvp.debug.isShowPlayerPlayStartTime&&e.currentTime>0&&(i.log("视频加载时间:"+(Date.now()-ddvp.debug.playerPlayStartTime)/1e3+"秒"),ddvp.debug.isShowPlayerPlayStartTime=!0);var t=e.cache;""===e.videoData.totalDuration&&e.videoTag.duration&&(t.duration=e.videoData.duration=e.videoData.totalDuration=e.videoTag.duration);var a=e.duration=t.duration,s=e.currentTime=o(e);if(s>0&&(r.IsIphone||e.hidePoster(),e._hideLoading(),s>1)){e._sendRealVVFlag||(e._sendRealVVFlag=!0),t.isRemHistory&&(e._playByHistoryFlag||d(e),n(e)),s>0&&Math.abs(s-e._lastCurTime)>2&&(e._startPlayTime=$.now()),(r.IsIphone||r.IsOldWindowsPhone)&&e.$midModeList.oriHide(),e._lastCurTime=s,!e._sendEndFlag&&s>a-15&&(e._sendEndFlag=!0),null===e._traceHeartInterval&&(e._traceHeartInterval=setInterval(function(){},12e4)),e._changeModeFlag=!1,e._dragRangeFlag=!1,e._firstWaitingFlag=!1,r.IsIphone||r.IsOldWindowsPhone||/Android\/?\s?2\../i.test(r.UA)||r.IsQQBrowser||r.IsUCBrowser?e._showPlayBtn():r.IsIphone||r.IsIpad||e._showPauseBtn();var l=s/a*100+"%";if(s>=a&&t.timeLimit===a){s=a,l="100%";var c=t.timeLimit,u=(c-c%60)/60;u=c%60===0?u:u+1}s>a&&(s=a),e.$ctrlCurTime.html($.formatSeconds(s)),e.$ctrlDuration.html($.formatSeconds(a)),e._dragFlag||e.$ctrlCurPlayedBar.css({width:l}),r.IsUCBrowser&&r.IsIphone&&parseInt(s,10)===parseInt(a,10)&&e._fireEvent("ended")}})},l=function(e){e.$ctrlDragAnchor.on(r.START_EVENT,function(t){return clearTimeout(e._hideMainCtrlTime),clearTimeout(e._rewindForwardInterval),e.$midRewindForwardCon.oriShow(),e._dragFlag=!0,e._dragRangeFlag=!0,e._touchStratX=t.touches&&t.touches[0]?t.touches[0].pageX:t.pageX,!1}),e.$ctrlDragAnchor.on(r.MOVE_EVENT,function(t){if(e._dragFlag){var r=e.$ctrlTrackBar.width(),a=e.duration,i=e.currentTime;clearTimeout(e._hideMainCtrlTime),clearTimeout(e._rewindForwardInterval);var o=function(t,r){e.$mid.oriShow(),i>t?e.$midRewindForwardCon.addClass("rewind").removeClass("forward"):e.$midRewindForwardCon.addClass("forward").removeClass("rewind"),e._moveTime=t,e.$midTime.html($.formatSeconds(t)),e.$ctrlCurPlayedBar.width(t/r*100+"%")};e._touchMoveX=t.touches&&t.touches[0]?t.touches[0].pageX:t.pageX;var n=a/r*(e._touchStratX-e._touchMoveX)*-1,d=i+n;0>d?o(0,a):d>a?o(a,a):o(d,a)}return!1}),e.$ctrlDragAnchor.on(r.END_EVENT+" mouseout",function(){return e._dragFlag&&(e._dragFlag=!1,e.seekTo(e._moveTime),e._startPlayTime=$.now(),e._rewindForwardInterval=setTimeout(function(){e.$midRewindForwardCon.oriHide()},2e3),e._hideMainCtrlTime=setTimeout(function(){e._hideMainCtrl()},3e3)),!1})},c=function(e){e.$ctrlBar.on(r.END_EVENT,function(){return!1}),e.$ctrlTrackBar.on(r.START_EVENT,function(t){var r=$(this),a=t.touches&&t.touches[0]?t.touches[0].pageX:t.pageX,i=a-r.offset().left,o=r.width(),n=e.duration/o*i;return e._startPlayTime=$.now(),e.seekTo(n),!1})};t.prototype._initCtrlProgress=function(){this._sendRealVVFlag=!1,this._sendEndFlag=!1,this._playByHistoryFlag=!1,this._makeHistoryFlag=!1,this._lastCurTime=0,this._startPlayTime=0,this._bufferCount=0,this._traceHeartInterval=null,this._rewindForwardInterval=null,this._dragRangeFlag=!1,this._changeModeFlag=!1,this._firstWaitingFlag=!0,this._dragFlag=!1,this._touchStratX=0,this._touchMoveX=0,this._moveTime=-1,s(this),"live"!==this.config.mediaType&&(l(this),c(this))}});