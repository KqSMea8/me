define("carchoose",function(o){var e=o("didi-component-carchoose/iscroll-lite.js");$("<style>").html(".choose-cartype-layer ul,.choose-cartype-layer li{list-style:none;padding:0}.choose-cartype-layer ul,.choose-cartype-layer li,.choose-cartype-layer h3,.choose-cartype-layer section{padding:0;margin:0}.choose-cartype-layer section{margin:0 6%}.choose-cartype-layer{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#fff;z-index:10}.choose-cartype-layer section{margin:0;position:absolute;top:0;left:0;width:100%;height:100%;background-color:#f0f0f0}.choose-cartype-layer h3{margin-right:20px;padding-left:20px;color:#333;line-height:2;font-family:Helvetica;font-size:1.2rem;font-weight:400;background-color:#f0f0f0;background-image:url(http://static.xiaojukeji.com/didialift/hybrid/images/border-bottom-1px-e0.png),url(http://static.xiaojukeji.com/didialift/hybrid/images/border-top-1px-e0.png);background-repeat:repeat-x;background-position:0 bottom,0 top;background-size:auto 1px,auto 1px;-webkit-background-size:auto 1px,auto 1px}.choose-cartype-layer h3:first-child{background-image:url(http://static.xiaojukeji.com/didialift/hybrid/images/border-bottom-1px-e0.png);background-position:0 bottom;background-size:auto 1px;-webkit-background-size:auto 1px}.choose-cartype-layer ul{color:#333;font-size:1.4rem;line-height:2.85714;padding-left:20px;margin-right:20px;background-color:#fff}.choose-cartype-layer ul li{display:block;color:#333;font-size:1.4rem;background:url(http://static.xiaojukeji.com/didialift/hybrid/images//border-bottom-1px.png) repeat-x 0 bottom;background-size:auto 1px;-webkit-background-size:auto 1px}.choose-cartype-layer ul li.selected{color:#ff8903}.choose-cartype-layer ul li:last-child{background:0 0}section.choose-brand-layer{z-index:11;background:#fff}section.choose-type-layer{left:100%;z-index:13;-moz-box-shadow:-1px 0 5px rgba(0,0,0,.14);-webkit-box-shadow:-1px 0 5px rgba(0,0,0,.14);box-shadow:-1px 0 5px rgba(0,0,0,.14)}section.choose-color-layer{left:100%;z-index:14;-moz-box-shadow:-1px 0 5px rgba(0,0,0,.14);-webkit-box-shadow:-1px 0 5px rgba(0,0,0,.14);box-shadow:-1px 0 5px rgba(0,0,0,.14)}.choose-cartype-shortcut{z-index:12;color:#007aff;font-size:1.2rem;font-family:verdana;position:fixed;right:0;top:10%;width:20px}.choose-cartype-shortcut>div{text-align:center;line-height:16px;font-weight:700}.choose-cartype-shortcut a{display:block;width:100%;height:16px;color:#007aff}.choose-cartype-shortcut a:active,.choose-cartype-shortcut a.selected{color:#ff8b03}").appendTo($(document.body)),function(o){function t(){m(),w(),k()}function i(){y()}function n(){window.dd&&window.dd.dialog&&window.dd.dialog.loading("正在加载",2e3)}function a(){window.dd&&window.dd.dialog&&window.dd.dialog.loading("正在加载",100)}function r(){$&&$.height(o(window).height())}function c(){var e=navigator.userAgent;$=o('<div class="choose-cartype-layer" />').prependTo("body"),(/MicroMessenger/.test(e)||!/Android/.test(e))&&$.css("visibility","hidden"),r(),$.append('<section class="choose-brand-layer"><div></div></section>'),$.append('<section class="choose-type-layer"><div></div></section>'),$.append('<section class="choose-color-layer"><div></div></section>'),M=o(".choose-brand-layer").append('<div class="choose-cartype-shortcut"></div>'),F=o(".choose-type-layer"),O=o(".choose-color-layer"),$shortcut=M.find(".choose-cartype-shortcut"),s()}function s(){n(),o.ajax({url:N,dataType:"json",success:function(o){a(),"0"==o.errno&&(l(o.data),$.css("visibility","visible"),y(),d(o.data),p(),h(),f(),u())},error:function(){a()}})}function d(o){var e=[];for(var t in o)e.push(['<div><a href="javascript:void(0);" data-anchor="car-brand-',t,'">',t,"</a></div>"].join(""));$shortcut.html(e.join(""))}function l(o){var t=[];for(var i in o){t.push(['<h3 id="car-brand-'+i+'">',"<div><span>"+i+"</span></div>","</h3>","<ul>"].join(""));for(var n=o[i],a=0;a<n.length;a++)t.push(['<li data-brand-id="'+n[a].brand_id+'">',n[a].name,"</li>"].join(""));t.push("</ul>")}M.find("div").html(t.join("")),z?z.refresh():z=new e(M[0],{click:!0,deceleration:L})}function u(){$shortcut.on("click",function(e){var t,i=o(e.target).closest("a");i.length&&(i.addClass("selected"),setTimeout(function(){i.removeClass("selected")},200),t=i.data("anchor"),z.scrollToElement("#"+t,0))})}function p(){M.on("click",function(e){var t,i,r=o(e.target).closest("li");r.length&&r!=Z&&(Z&&Z.removeClass("selected"),Z=r,r.addClass("selected"),t=r.data("brand-id"),i=r.text(),E.brand={id:t,name:i},X[t]?(g(X[t]),x(),k()):(w(),k(),n(),o.ajax({url:R+"?carbrand="+t,dataType:"json",success:function(o){a(),0==o.errno&&(X[t]=o.data,g(o.data),x())},error:function(){a()}})))})}function h(){F.on("click",function(e){var t,i,r,c=o(e.target).closest("li");c.length&&c!=_&&(_&&_.removeClass("selected"),_=c,c.addClass("selected"),t=c.data("brand-type-id"),i=c.text(),r=new RegExp(E.brand.name.replace(/[\\\|*+?^$]/g,"\\$&"),"g"),E.type={id:t,shortName:i.replace(r,""),name:i},A?v():(k(),n(),o.ajax({url:S,dataType:"json",success:function(o){a(),0==o.errno&&(A=o.data,b(o.data),v())},error:function(){a()}})))})}function f(){O.on("click",function(e){var i,n,a,r=o(e.target).closest("li");r.length&&(i=r.data("color-id"),n=r.text(),E.color={id:i,name:n},a=I.subStrg(E.brand.name,6)+" "+I.subStrg(E.type.shortName,4)+" "+E.color.name,U&&U({value:E,carInfo:a}),t())})}function g(o){for(var t=["<ul>"],i=o,n=0;n<i.length;n++)t.push(['<li data-brand-type-id="'+i[n].brand_type_id+'">',i[n].brand_type_name,"</li>"].join(""));t.push("</ul>"),F.find("div").html(t.join("")),C?C.refresh():C=new e(F[0],{click:!0,deceleration:L})}function b(o){var t=["<ul>"],i=o;for(var n in i)t.push(['<li data-color-id="'+n+'">',i[n].name,"</li>"].join(""));t.push("</ul>"),O.find("div").html(t.join("")),D?D.refresh():D=new e(O[0],{click:!0,deceleration:L})}function y(){$shortcut[0].style.display="block",T($[0],o(window).width(),0),T($[0],0,150)}function m(){Z&&Z.removeClass("selected"),Z=null,T($[0],0,0),T($[0],o(window).width(),150),$shortcut[0].style.display="none"}function x(){T(F[0],-.66*o(window).width(),150)}function w(){_&&_.removeClass("selected"),_=null,T(F[0],-.66*o(window).width(),0),T(F[0],0,150)}function v(){T(O[0],-.33*o(window).width(),150)}function k(){T(O[0],-.33*o(window).width(),0),T(O[0],0,150)}function T(o,e,t,i,n){var a=o&&o.style,r="",c="";if(i||(i="linear"),n||(n=0),a){if("[object Array]"===Object.prototype.toString.call(e))switch(e.length){case 3:r=c="translate3d("+e[0]+"px,"+e[1]+"px,"+e[2]+"px)";break;case 2:r=c="translate("+e[0]+"px,"+e[1]+"px)translateZ(0)";break;case 1:r="translate("+e[0]+"px,0)translateZ(0)",c="translateX("+e[0]+"px)";break;default:r="translate("+e[0]+"px,0)translateZ(0)",c="translateX("+e[0]+"px)"}else{if(isNaN(parseInt(e)))return;r="translate("+e+"px,0)translateZ(0)",c="translateX("+e+"px)"}a.webkitTransitionDuration=a.MozTransitionDuration=a.msTransitionDuration=a.OTransitionDuration=a.transitionDuration=t+"ms",a.webkitTransitionTimingFunction=a.MozTransitionTimingFunction=a.msTransitionTimingFunction=a.OTransitionTimingFunction=a.transitionTimingFunction=i,a.webkitTransitionDelay=a.MozTransitionDelay=a.msTransitionDelay=a.OTransitionDelay=a.transitionDelay=n+"ms",a.webkitTransform=r,a.msTransform=a.MozTransform=a.OTransform=c}}function j(o){return document.activeElement&&document.activeElement.blur(),$?void setTimeout(function(){i()},300):(o=o||{},N=o.brandsURL||"/pinche/cartype/getcarbrand",R=o.typesURL||"/pinche/cartype/getcartype",S=o.colorsURL||"/pinche/cartype/getcolor",U=o.onselect||function(){},void c())}var z,C,D,$,M,F,O,Z,_,A,E,L,N,R,S,U,X={};L=.002,E={brand:{},type:{},color:{}},o(window).on("resize",function(){r()});var I=function(){var o=function(o){return o.replace(/[^\x00-\xff]/g,"**").length},e=function(e,t){if(null==e)return"";if(o(e)>t){for(var i,n=0,a="",r=0;r<e.length;r++)if(i=e.charAt(r),n+=o(i),n>=t){a=e.substring(0,r+1);break}return a+="..."}return e};return{LenB:o,subStrg:e}}();o.didiCarChoose=function(o){j(o)}}(Zepto)});