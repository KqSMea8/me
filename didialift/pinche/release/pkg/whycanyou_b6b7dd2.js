define("page/whycanyou/button/button.js",function(){});
;define("page/whycanyou/login/login.js",function(n,o,e){var i=n("tool/tool.js"),l=Zepto(".layer_login"),t=l.find.bind(l);t.__proto__=Zepto;var a,r,d=t("#phone_input"),u=t(".login_confire_btn"),c=t(".lagin_layer_close"),h=i.parseEqual(location.search.slice(1)).channel;o=e.exports=function(n){return r=n,e.exports},o.show=function(n,o){"function"==typeof n&&(o=n,n=null),n&&t(".login_title").html(n),a=o,l.show()},l.on("touchmove",function(n){n.preventDefault()}),u.on("click",function(){return null==i.regular.is_phone_number(d.val().trim())?(l.hide(),void dd.dialog.alert({tip:"请输入正确的手机号码",btn:{val:"确定",handler:function(){l.show()}}})):(dd.dialog.loading("正在提交",5e3),void t.ajax({type:"POST",url:r,data:{phone:d.val(),channel:h},timeout:"5000",success:function(n){var o=JSON.parse(n);0==o.errno?(dd.dialog.loading("正在提交",0),a(),l.hide()):dd.dialog.alert(o.errmsg)},error:function(){l.hide(),dd.dialog.alert({tip:"网络请求失败,请稍后重试",btn:{val:"确定",handler:function(){l.show()}}})}}))}),c.on("click",function(n){d.blur(),l.hide(),n.preventDefault()})});
;define("page/whycanyou/first/first.js",function(a,e){function t(){var a=e.check_filed();a!==!1&&(a=$.extend({},pageParams.upload_data,a),window.dd.dialog.loading("正在提交",5e3),$.ajax({type:"POST",url:pageParams.submit_url,data:a,success:function(a){var e;try{if(e=JSON.parse(a),0!=e.errno)return"101"==e.errno&&setTimeout(function(){location.replace(pageParams.homeurl)},2e3),dd.dialog.alert(e.errmsg);var t=e.data.shareinfo.link;if(t=t.replace(new RegExp("^"+location.protocol+"\\/\\/"+location.host),""),window.history.pushState){window.history.pushState({},document.title,t);var n=$.extend({step:2},e.data);d(n)}else location.href=t}catch(o){return dd.dialog.alert("网络有点不给力，请稍后再试哦~")}dd.dialog.loading("正在提交",0)},error:function(){dd.dialog.alert("网络有点不给力，请稍后再试哦~")}}))}function n(a){a!==!1&&v.empty().addClass("upload_box_hide")}function o(a,e){function t(){var r=Date.now()-n;window.DidiJSBridge?a(!0,r):e>r?setTimeout(t,o):a(!1,r)}var n=Date.now(),o=100;e=e||2e3,t()}function r(a){v.attr("data-value",a),$(".head_pic_source").css({"background-image":"url("+a+")"})}function i(){}function l(a){var e=dd.dialog,t={data:$.extend({},pageParams.upload_data),url:pageParams.upload_url,outputWidth:100,outputHeight:100,filekey:"file",onSuccessUpload:function(a){try{if(a=JSON.parse(a),"0"==a.errno)r(a.data);else{if("101"!=a.errno)return void e.alert(a.errmsg);e.alert("请重新登录")}}catch(t){return e.alert("上传失败，请重试！"),void i()}},onCancelUpload:function(){},onFailedUpload:function(){dd.dialog.alert("上传失败，请重试！")}};new c(a,t)}var d,u=a("page/whycanyou/login/login.js")(pageParams.loginurl),c=a("upload/upload.js"),s=e.$container=$(".first"),f=!1;e.wakeup=function(a,e){d=e,f||(f=!0)};var p=[["人人能当堵侠，不做闪电侠","全民顺风，挑战早晚高峰"],["下班六点，到家九点","全民顺风，挑战早晚高峰"],["线上越来越快，路上越来越慢","全民顺风，挑战早晚高峰"]],h=p[Math.round(Math.random()*(p.length-1))],g={username:{alert:"请填写你的大名",placeholder:"滴滴小伙伴"},whycontent:{alert:"请填写你的第一句倡议",placeholder:h[0]},cancontent:{alert:"请填写你的第二句倡议",placeholder:h[1]}},m=["username","whycontent","cancontent"];m.forEach(function(a){$("#"+a).val(g[a].placeholder).one("touchstart",function(){this.value=""})}),e.check_filed=function(){var a,e={};e[v.attr("data-name")]=v.attr("data-value");for(var t=0,n=m;a=n[t++];){var o=$("#"+a).val().trim();if((""==o||o==g.username.placeholder)&&1==t)return dd.dialog.alert({title:"",tip:g[a].alert,btn:{handler:function(){$("#"+a).focus()}}}),!1;e[a]=o}return e},$(["#"+m[1],"#"+m[2]].join(",")),$("#"+m[0]).on("blur",function(){this.value=this.value.replace(/([\u4E00-\u9FA5|\w]{5})(.+)/,"$1")}),s.find(".btn-common").on("click",function(){0==pageParams.islogin?u.show(function(){pageParams.islogin=1,t()}):t()});var v=$(".upload_box");$(function(){$(".bg").css({"min-height":"0"})}),l(v[0]),o(n,2e3)});
;define("page/whycanyou/second/second.js",function(n,i){var e,t,o=i.$container=$(".second");i.wakeup=function(n,i,o){e=i,t=o;{var a=$(".user_sum");a.offset()}a.css({}),$(function(){var i=n.shareinfo||pageParams.shareinfo;if(window.initWxShare(i),window.DidiJSBridge){var e=$.extend({},i,{img_url:i.imgUrl});window.initDidiShare({btn:$(".btn-share").addClass("color-origin-btn").html("分享我的倡议"),shareConfig:e})}})},i.wakeup_before=function(n){n.username,i.sync_view(n)},i.sync_view=function(n){var i="data-bindkey";$("["+i+"]").each(function(e,t){var o=t.getAttribute(i).trim();o in n&&(t.firstElementChild&&"IMG"===t.firstElementChild.tagName?t.firstElementChild.src=n[o]:t.innerHTML=n[o])}),2==n.step?($(".btn_box_third").hide(),$(".btn_box_second").show()):($(".btn_box_third").show(),$(".btn_box_second").hide())},o.find(".btn-join").on("click",function(){3==pageParams.step&&(location.href=pageParams.homeurl)}),o.find(".btn-upload").on("click",function(){t()})});
;define("page/whycanyou/main.js",function(e,a){function t(e,a,t,n){var i=$(".container");return e[0]==a[0]?(a.show(),n&&n(),void t()):(e.addClass("from_page"),a.addClass("to_page"),i.attr("class","main animate begin_animate"),n&&n(),setTimeout(function(){i.attr("class","main animate end_animate")},0),void setTimeout(function(){e.removeClass("from_page").hide(),a.removeClass("to_page").show(),t()},350))}function n(e,a){return void 0===a&&(a=e.getAttribute("data-offset")),a=a.split(/\s*,\s*/),{x:a[0],y:a[1],w:a[2],h:a[3]}}var i,o,s,r=e("page/whycanyou/first/first.js"),c=e("page/whycanyou/second/second.js"),u=[r,c],f=n($(".bg")[0]),h=$(".main"),d=Math.min(Math.max(pageParams.step-1,0),u.length-1)||0,p=function(e,a){o=function(t){t=$.extend({},a,t),e<u.length-1?p(e+1,t):e===u.length-1&&location.replace(pageParams.successurl)},s=function(t){t=$.extend({},a,t),e>0&&p(e-1,t)},t(h.eq(d),h.eq(e),function(){u[e].wakeup(a||{},o,s),i=location.href},function(){u[e].wakeup_before&&u[e].wakeup_before(a||{},o,s)}),d=e};addEventListener("hashchange",function(){location.href===i&&s()}),a.update=function(){$("div[data-offset]").each(function(e,a){var t=n(a),i=innerWidth,o=i/f.x,s=f.y*o,r=s*t.y/f.y,c=i*t.x/f.x,u=["left:"+c+"px","top:"+r+"px","display: block"];if(t.w){var h=s*t.w/f.y;u[u.length]=["width:"+h+"px"]}if(t.h){var d=i*t.h/f.x;u[u.length]=["height:"+d+"px"]}a.style.cssText=u.join(";")})},$(function(){window.initWxShare(pageParams.shareinfo)});var l;$(window).on("resize",function(){clearTimeout(l),l=setTimeout(a.update,100)}),h.hide(),a.update(),p(d,{step:pageParams.step})});