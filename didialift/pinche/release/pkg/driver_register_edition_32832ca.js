define("page/driver_register_edition/tool.js",function(t,n){{var e,i;n.regular={is_Chinese_name:function(t){var n=/^[\u4E00-\u9FA5]{2,}$/;return n.test(t)?!0:!1},is_ID_card:function(t){var n=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;return n.test(t)===!1?!1:!0},is_carNo:function(t){var n=/^[A-Za-z]{1}[A-Za-z0-9]{5}$/;return n.test(t)?!0:!1}}}n.warning=function(t,r){clearTimeout(i),o(),n.warning.pos(),e.html(t).show(),i=setTimeout(function(){e.hide()},r||2e3)},n.warning.close=function(){e.hide()};var o=n.warning.init=function(t,i){return e?!1:(e=$("<div>").attr("id","waring"+~~(1e6*Math.random())).attr("style",["height: 28px","line-height: 28px","line-height: 28px","background-color: #ff5050","text-align: center","font-size: 1.4rem","color: #fff","position: fixed","width: 100%","display: none"].join(";")),n.warning.pos(t,i),$(document.body).append(e).on("scroll",function(){n.warning.pos()}),!0)};n.warning.pos=function(t,n){n=n||pageYOffset,t=t||0,e.css({left:t,top:n})},n.warning.close=function(){e&&e.hide()};var r=n.localCache={set:function(t,n){try{return localStorage.setItem(t,n),!0}catch(e){return!1}},get:function(t){try{return localStorage.getItem(t)}catch(n){return!1}},remove:function(t){try{return localStorage.removeItem(t),!0}catch(n){return!1}},instance:function(t){return new a(t)}},a=function(t){this._key=t,this._saveObject=JSON.parse(r.get(t)||"{}")};a.prototype.save_cache=function(t,n){this._saveObject[t]=n,r.set(this._key,JSON.stringify(this._saveObject))},a.prototype.remove_cache=function(t){delete this._saveObject[t],r.set(this._key,JSON.stringify(this._saveObject))},a.prototype.get=function(t){var n=$.extend({},this._saveObject);return t?n[t]||"":n},a.prototype.clean=function(){r.remove(this._key)},n.showLoading=function(){window.dd&&window.dd.dialog&&window.dd.dialog.loading("正在加载",1e5)},n.closeLoading=function(){window.dd&&window.dd.dialog&&window.dd.dialog.loading("正在加载",0)},n.warning_text=function(t){for(var n=18,e=100;n--;)!function(n){setTimeout(function(){t[(n%2==1?"remove":"add")+"Class"]("waring_input")},n*e)}(n)}});
;define("page/driver_register_edition/first/first.js",function(e,t){function a(e){return"string"!=typeof e&&(e=e.getAttribute("name")),1==pageParams.filed_list[e].changeable}function r(e){return"string"!=typeof e&&(e=e.getAttribute("name")),3==pageParams.filed_list[e].verify}function n(e,t){t=t||e.attr("name"),e.val(pageParams.filed_list[t]&&pageParams.filed_list[t].value||u.get(t)).attr("disabled",a(t)?null:"")}function i(){function e(e){var t=_.txtToJson(e);if("102"==t.errno)location.replace(pageParams.gologinurl);else if("0"==t.errno)u.clean(),c();else{if("3002"!=t.errno)return"6010"==t.errno?void d.confirm({title:"",text:"该身份证已被注册，如果仍需注册，请进行申诉。",confirm:{val:"我要申诉",handler:function(){location.href="http://static.xiaojukeji.com/didialift/hybrid/pages/help/help-accountDatumOQ06.html"}}}):"6009"==t.errno?void d.confirm({title:"",text:"车辆已被注册。如果不是你本人或熟人操作，你可以通过申诉来进行车主认证。",confirm:{val:"我要申诉",handler:function(){location.href="http://static.xiaojukeji.com/didialift/hybrid/pages/help/help-accountDatumOQ07.html"}}}):d.alert(t.errmsg||"");u.clean(),c()}f.closeLoading()}var i=g.find("#txt_licence"),o=g.find("#txt_realname");n(o),n(i),o.on("blur",function(){var e=g.find("#txt_realname").val();f.regular.is_Chinese_name(e)===!1?(f.warning("请填写正确的中文姓名"),f.warning_text(o)):u.save_cache(this.getAttribute("name"),e),l()}),i.on("blur",function(){var e=g.find("#txt_licence").val();f.regular.is_ID_card(e)===!1?(f.warning("请填写正确的身份证号码"),f.warning_text(i)):u.save_cache(this.getAttribute("name"),e),l()});var s=o.attr("name");r(s)&&a(s)&&g.addClass("verify_failed"),g.find(".next_btn").on("click",function(){var a=t.check_filed();if(0!=a){var r=$.extend({step:1,token:pageParams.upload_data.token,regfrom:pageParams.regfrom,source:pageParams.source},a);f.showLoading(),$.ajax({type:"GET",url:pageParams.reg_url,data:r,success:e,error:function(){d.alert("网络有点不给力，请稍后再试哦~")}})}});var d=dd.dialog,_=dd.base;g.one("touchstart",function(){g.removeClass("verify_failed")})}function l(){for(var e=0;e<_.length;e++)if(a(_[e])!==!1&&f.regular[m[e]](_[e].value)===!1)return g.trigger("is_full_fill",!1),!1;g.trigger("is_full_fill",!0)}var o,c,f=e("page/driver_register_edition/tool.js"),s=dd.dialog,u=f.localCache.instance("driver_register_first"),d=!1,g=t.$container=$(".form_first");t.wakeup=function(e,t,a){c=function(){f.warning.close(),t()},o=function(){f.warning.close(),a()},d===!1&&(d=!0,i(),l())},t.check_filed=function(){var e=g.find("#txt_realname"),t=g.find("#txt_licence"),r=e.val(),n=t.val();if(f.regular.is_Chinese_name(r)===!1&&a(e.attr("name")))return s.alert({title:"",tip:"请填写正确的中文姓名",btn:{handler:function(){}}}),!1;if(f.regular.is_ID_card(n)===!1&&a(t.attr("name")))return s.alert({title:"",tip:"请填写正确的身份证号码",btn:{handler:function(){}}}),!1;var i={};return a(e.attr("name"))&&(i.drivelicensename=r),a(t.attr("name"))&&(i.drivelicensenumber=n),i};var _=[txt_realname,txt_licence],m=["is_Chinese_name","is_ID_card"]});
;define("page/driver_register_edition/foot/foot.js",function(){var e=!1,o="";$(".bt_foot").on("click",function(){var a=dd.dialog,r=dd.base;if(e===!0)return void(o&&a.alert(o));e=!0;var t={token:pageParams.upload_data.token,url:encodeURIComponent(location.href.replace(/#.+$/g,""))};r.ajax({method:"POST",url:pageParams.sendurltophone,data:t,succFunc:function(e){var t=r.txtToJson(e);0==t.errno?(o=t.errmsg,a.alert(t.errmsg)):a.alert("请重试")},failFunc:function(){e=!1,a.alert("网络有点不给力，请稍后再试哦~")}})})});
;define("page/driver_register_edition/hard_update.js",function(i,t){var n=i("tool/tool.js");t.lessThanVersion=function(i){return n.isWidthinApp()?n.getAppVersion()<n.standardizationAppVersion(i):!1},t.alertUpdate=function(){dd.dialog.alert({tip:"你的客户端版本太旧，更新后才能进行车主认证",btn:{val:"升级客户端",handler:function(){location.replace("http://diditaxi.com.cn/api/v1/share")}}})}});
;define("page/driver_register_edition/status/status.js",function(t,e){e.to=function(t){$(".status_item").removeClass("active").eq(t).addClass("active")}});
;define("page/driver_register_edition/second/layer/layer.js",function(require,exports,module){var Layer=module.exports=function(t){this.opt=$.extend({},t)},tpl_gesture=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="layer_box" style="display:none">\n	<div class="layer_bd">\n	<div class="topbar"><span class="close">&times;</span></div>\n	<!-- 左手.e_avatar_1;右手.e_avatar_2 -->\n	<div class="avatar_box '+(null==(__t=custom_class)?"":__t)+'">\n		<img src="'+(null==(__t=img_src)?"":__t)+'" alt="" />\n		<div class="arr"></div>\n	</div>\n	<div class="note_box">\n		<ol class="note_ls">\n		<li class="item"><i>1</i>请按照示例图提交手持行驶证的照片。</li>\n		<li class="item"><i>2</i>持证人须是驾驶证所有人，如他人持证则不予认证。</li>\n		<li class="item"><i>3</i>如人脸或行驶证有遮挡、太暗、模糊，则不予认证。</li>\n		</ol>\n	</div>\n	<div class="btn_ghost1">知道了,我要上传照片</div>\n	</div>\n</div>\n';return __p},tpl_card=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div style="display:none" class="layer_box_card">\n	<img src="'+(null==(__t=img_src)?"":__t)+'"/>\n</div>';return __p};Layer.GESTURE=0,Layer.CARD=1;var TPL_ARY=[];TPL_ARY[Layer.GESTURE]=tpl_gesture,TPL_ARY[Layer.CARD]=tpl_card,Layer.prototype={setup:function(){if(this._issetuped===!0)return!1;this._issetuped=!0;var t=TPL_ARY[this.opt.layerType]({custom_class:this.opt.custom_class,img_src:this.opt.img_src});this.$container=$(t).attr("id","layer"+~~(1e6*Math.random())),$(document.body).append(this.$container),this.bindEvent(this.$container)},show:function(t){var i=this;t&&this.setPic(t),this.update(),this.$container.css({opacity:"0",display:"block"}),setTimeout(function(){i.$container.css({opacity:"1"})},0)},setOpt:function(t){this.opt=$.extend(this.opt,{},t)},close:function(){var t=this;t.$container.css({opacity:"0"}),setTimeout(function(){t.$container.hide()},250)},bindEvent:function(t){function i(t){var i={w:100,h:100},n=t.touches[0];i.x=pageXOffset+innerWidth-i.w,i.y=pageYOffset,n.pageX<i.x+i.w&&n.pageX>i.x&&n.pageY<i.y+i.h&&n.pageY>i.y&&(e.close(),e.cancelEvent(t))}var e=this,n=function(t){e.cancelEvent(t)},s=e.update=function(){e.$container.css({top:pageYOffset,left:pageXOffset,height:innerHeight,width:innerWidth})};t.on("touchmove",n),t.on("touchstart",i),$(window).on("resize",s),$(window).on("scroll",s)},cancelEvent:function(t){t.preventDefault(),t.stopPropagation()}}});
;define("page/driver_register_edition/second/second.js",function(e,a){function t(e,a){var t=document.createElement("IMG");t.onload=function(){a(t),t.onerror=t=t.onload=null},t.onerror=function(){a(null),t.onerror=t=t.onload=null},t.src=e}function r(e){return"string"!=typeof e&&(e=e.getAttribute("name")),1==pageParams.filed_list[e].changeable}function n(e){return"string"!=typeof e&&(e=e.getAttribute("name")),1==pageParams.filed_list[e].display}function i(e){return"string"!=typeof e&&(e=e.getAttribute("name")),3==pageParams.filed_list[e].verify}function o(){function a(e){function a(){document.body.onfocus=null,x[e].close()}var t={data:$.extend({},pageParams.upload_data),url:pageParams.api_upload_url,outputWidth:T[e][0],outputHeight:T[e][1],filekey:"file",onSuccessUpload:function(t){try{if(t=JSON.parse(t),"0"==t.errno)E(k[e],t.data);else{if("101"!=t.errno)return void m.alert(t.errmsg);location.replace(pageParams.gologinurl)}}catch(r){return m.alert("服务器故障，上传失败，请重试！"),void O(k[e],r)}a()},onCancelUpload:function(){a()},onFileSelect:function(e,t){a(),t()},onFailedUpload:function(){a(),m.alert("上传超时，请重试！"),a()}},r=x[e].$container;r.show(),new n(r[0],t),r.hide()}function t(a){function t(){document.body.onfocus=null,x[a].close()}var r=x[a].$container;r.on("click",function(){var r=e("ddbridge/ddbridge.js"),n=$.extend({},pageParams.upload_data,{web_token:pageParams.upload_data.token});delete n.token,r.uploadImage(n,function(e){try{e=JSON.parse(e),E(k[a],e.data.data)}catch(r){O(k[a],r)}t()},null,pageParams.api_upload_url)})}var n=e("upload/upload.js");$.each(b.find(".file_select"),function(e,n){function o(){document.body.onfocus=null,x[e].close()}var l=$(n);if(r(n)===!1)return void l.addClass("disabled");i(k[e])&&r(k[e])&&l.addClass("verify_failed"),"string"==typeof j[e]?(x[e].setOpt({img_src:j[e]}),x[e].setup()):j[e](function(a){var t=["e_avatar_1","e_avatar_2"];x[e].setOpt({img_src:a,custom_class:t[pageParams.gesturesample-1]}),x[e].setup()});var s=!1;l.on("click",function(){if(x[e].show(),document.body.onfocus=o,s!==!0){s=!0,$(this).removeClass("verify_failed");var r=window.DidiJSBridge;r&&/android/i.test(navigator.userAgent)?t(e):a(e),x[e].show()}},!1)})}function l(){o(),k.forEach(function(e){var a=pageParams.filed_list[e].value||h.get(e);a&&E(e,a)}),b.find(".form_second .previous_btn").on("click",function(){f()}),b.find(".next_btn").on("click",function(){function e(e){var a=r.txtToJson(e);if("102"==a.errno)location.replace(pageParams.gologinurl);else if("0"==a.errno)h.clean(),u({travelauthpicurl:A.travelauthpicurl});else{if("3002"!=a.errno)return n.alert(a.errmsg);h.clean(),u({travelauthpicurl:A.travelauthpicurl})}g.closeLoading()}var t=a.check_filed();if(t!==!1){g.showLoading(),$.ajax({type:"GET",url:pageParams.reg_url,data:$.extend({step:2,token:pageParams.upload_data.token},t),success:e,error:function(){n.alert("网络有点不给力，请稍后再试哦~")}});var r=dd.base,n=dd.dialog}})}function s(){for(var e=0;e<k.length;e++)if(r(b.find(P[e])[0])!==!1&&!A[k[e]])return b.trigger("is_full_fill",!1),!1;b.trigger("is_full_fill",!0)}function c(e){return e in G?G[e]:(dd.dialog.alert("服务器错误，没有成功获取示例手势，请稍候再试"),"")}function d(e){function a(e){var a=dd.base.txtToJson(e);"0"==a.errno||(a.gesturesample=-1),pageParams.gesturesample=a.gesturesample,S=c(a.gesturesample);for(var t;t=J.shift();)t(S)}if(pageParams.gesturesample)return e(c(pageParams.gesturesample));if(S)return void e(S);if(J[J.length]=e,!(J.length.length>1)){var t=pageParams.gesture_url;$.ajax({method:"GET",url:t,data:{},success:a,error:function(){m.alert("获取手势图失败，因为网络有点不给力，请稍后再试哦~")}})}}var u,f,p=e("page/driver_register_edition/second/layer/layer.js"),g=e("page/driver_register_edition/tool.js"),_="http://static.xiaojukeji.com/pinche/release/page/driver_register_edition/second/driver_card_050b750.png",v="http://static.xiaojukeji.com/pinche/release/page/driver_register_edition/second/car_license_e5ed36a.png",m=(pageParams.gesturesample,dd.dialog),h=g.localCache.instance("driver_register_second"),y=!1,b=a.$container=$(".form_second");a.wakeup=function(e,a,t){if(u=a,f=t,y===!1){y=!0;var r=!0;if($.each(k,function(e,a){return n(a)?(r=!1,!1):void 0}),r)return s(),void u();l()}};var k=["driveauthpicurl","travelauthpicurl","gestureauthpicurl"],P=[".driving_licence_front",".driving_licence_backend",".car_photo"],j=[_,v,d],x=[new p({layerType:p.CARD}),new p({layerType:p.CARD}),new p({layerType:p.GESTURE,custom_class:""})],w=213/145,C=500,T=[[C,C/w],[C,C/w],[C,C]],A={},E=function(e,a){var r=k.indexOf(e);if(-1!==r){var n=$(P[r]);A[e]=a,n.addClass("photo_uploaded"),t(a,function(a){return null===a?(dd.dialog.alert({title:"",tip:"图片加载失败，请重新上传。",btn:{handler:function(){}}}),void O(e)):(a.className="pic",void n.find(".shadow").html(a))}),h.save_cache(e,a),s()}},O=function(e){var a=k.indexOf(e);-1!==a&&($pick_node=$(P[a]),$pick_node.removeClass("photo_uploaded"),delete A[e],h.remove_cache(e),s())};a.check_filed=function(){var e,a=!0,t={};if($.each(k,function(n,i){return r(i)!==!1?(t[i]=A[i],void 0==t[i]?(e=n,a=!1):void 0):void 0}),a===!1){var n=$(P[e]).find(".select_tips").text()||"完整资料";return m.alert({title:"",tip:"请"+n,btn:{handler:function(){}}}),!1}return t};var S=!1,J=[],G={1:"http://static.xiaojukeji.com/pinche/release/page/driver_register_edition/second/layer/images/avatar_left_1b52add.jpg",2:"http://static.xiaojukeji.com/pinche/release/page/driver_register_edition/second/layer/images/avatar_right_de4cc67.jpg"}});
;define("page/driver_register_edition/third/select.js",function(e,t,n){{var l=dd.base,a=function(){for(var e=document.getElementsByClassName("select-wall"),t=0,n=e.length;n>t;t++)document.body.removeChild(e[t])},o=function(){var e=document.createElement("div");e.id="d-wall",e.className="select-wall",e.style.width=document.clientWidth+"px",e.style.height=document.body.scrollHeight+"px",document.body.appendChild(e)};n.exports=function(e,t,n){function s(e){var t=0,n=0;e.addEventListener("touchstart",function(e){if(e.preventDefault(),!e.touches.length)return!1;var n=e.touches[0];t=n.pageY-this.offsetTop},!1),e.addEventListener("touchmove",function(e){if(e.preventDefault(),!e.touches.length)return!1;var l=e.touches[0],a=l.pageY-this.offsetTop;n=t-a,t=a,this.scrollTop+=n},!1),e.addEventListener("touchend",function(e){if(e.preventDefault(),!e.changedTouches.length)return!1;t=0,n=0;var l=this.scrollTop,a=l%44;22>a?this.scrollTop-=a:this.scrollTop+=44-a},!1)}var i=n||[],r=[],c=t.getElementsByClassName("cancel")[0],d=t.getElementsByClassName("confirm")[0],u=t.getElementsByClassName("options");l.touch(e,function(){for(var e=document.getElementsByClassName("select"),l=0,a=e.length;a>l;l++)e[l].style.display="none";t.style.display="block",o();for(var s=null,i="",r=null,c=0,d=u.length;d>c;c++){s=u[c],i=n[c],r=s.getElementsByTagName("li");for(var h=0,v=r.length;v>h;h++)r[h].getAttribute("data-id")==i&&(s.scrollTop=44*h)}},!1),c.addEventListener("click",function(){t.style.display="none",a()},!1);var h=function(e){var t=document.createEvent("Events");return t.initEvent(e,!0,!0),t};d.addEventListener("click",function(){for(var n=null,l=null,o=0,s=u.length;s>o;o++){n=u[o];var c=n.scrollTop/44,l=n.getElementsByTagName("li")[c];i[o]=l.getAttribute("data-id"),r[o]=l.getAttribute("data-show")}var d=e.value;e.value=r.join(""),e.setAttribute("data-id",i.join("")),d!=e.value&&e.dispatchEvent&&e.dispatchEvent(h("change")),t.style.display="none",a()},!1);for(var v=0,f=u.length;f>v;v++)s(u[v],v)}}});
;define("page/driver_register_edition/third/third.js",function(a,t){function e(){function a(a){var i=e.txtToJson(a),n=txt_carone.getAttribute("name"),o=pageParams.filed_list[n].value||g.get(n)||"1",d=i.data[o];if(txt_carone.value=d||g.get(n+"_zh"),"0"==i.errno){for(var u=i.data,s=i.sort,f="",_=0,p=s.length;p>_;_++)f+='<li data-id="'+s[_]+'" data-show="'+u[s[_]]+'">'+u[s[_]]+"</li>";if(ulEl.innerHTML+=f,c(),!r(txt_carone))return void txt_carone.setAttribute("disabled","");l(txt_carone,t,[])}}var t=document.getElementById("carnoSelect"),e=dd.base;ulEl=t.getElementsByClassName("options")[0];var i=function(){e.ajax({method:"POST",url:"/pinche/cartype/getlicensehead",succFunc:a,failFunc:function(){}})};i()}function r(a){return"string"!=typeof a&&(a=a.getAttribute("name")),1==pageParams.filed_list[a].changeable}function i(a){return"string"!=typeof a&&(a=a.getAttribute("name")),3==pageParams.filed_list[a].verify}function n(){i("carcardnumber")&&r("carcardnumber")&&_.addClass("verify_failed");var n=_.find("#car_type");v.forEach(function(a){n.attr("data-"+a,pageParams.filed_list[a].value||g.get(a))}),n.val(pageParams.filed_list[v[0]].zhvalue+pageParams.filed_list[v[1]].zhvalue+pageParams.filed_list[v[2]].zhvalue||g.get(v[0]+"_zh"));var l=_.find("#txt_carnumber"),u=l.attr("name");l.val(pageParams.filed_list[u].value||g.get(u)).attr("disabled",r(u)?null:"");var f=_.find("#txt_carone");u=f.attr("name"),f.attr("data-id",pageParams.filed_list[u].value||g.get(u)||"1"),e();var p=car_type.getAttribute("name").split(",")[0];if(r(p)===!1)car_type.setAttribute("disabled","");else{var m=_.find("#car_type").on("click",function(t){function e(a){r.value=a.carInfo;$.each(a.value,function(t,e){var i;switch(t){case"color":i=v[2];break;case"brand":i=v[0];break;case"type":i=v[1]}r.setAttribute("data-"+i,e.id),g.save_cache(i,e.id),g.save_cache(i+"_zh",a.carInfo),c()})}var r=this;t.preventDefault(),t.stopPropagation(),a("carchoose/main.js"),$.didiCarChoose({brandsURL:pageParams.getcarbrand,typesURL:pageParams.getcartype,colorsURL:pageParams.getcolor,onselect:e})});m.on("focus",function(){m.blur()})}_.find(".next_btn").on("click",function(){function e(t){var e=n.txtToJson(t);if("102"==e.errno)location.replace(pageParams.gologinurl);else{if("0"!=e.errno&&"3002"!=e.errno)return e.errno in d?void i.confirm({title:d[e.errno].title,text:d[e.errno].text,confirm:{val:d[e.errno].confirm_val,handler:function(){location.href=d[e.errno].confirm_url}}}):i.alert(e.errmsg);a("ddbridge/ddbridge.js").updateDriverAuth({userAuthState:"1",car_auth_state:"1"}),g.clean(),o()}s.closeLoading()}var r=t.check_filed();if(0!=r){var i=dd.dialog,n=dd.base,c="车牌：{carbrand} 已注册，请确认车牌是否正确。如仍需注册该车牌，请申诉。";c=c.replace(/\{carbrand\}/,$("#txt_carone").val()+r.carcardnumber);var d={6010:{title:"",text:"该身份证已被注册，如果仍需注册，请进行申诉。",confirm_val:"我要申诉",handler_url:"http://static.xiaojukeji.com/didialift/hybrid/pages/help/help-accountDatumOQ06.html"},6009:{title:"",text:c,confirm_val:"我要申诉",confirm_url:"http://static.xiaojukeji.com/didialift/hybrid/pages/help/help-accountDatumOQ07.html"}};s.showLoading(),$.ajax({type:"GET",url:pageParams.reg_url,data:$.extend({step:3,commit:1,token:pageParams.upload_data.token},r),success:e,error:function(){i.alert("网络有点不给力，请稍后再试哦~")}}),$.ajax({method:"GET",dataType:"jsonp",url:pageParams.inviteurl,data:{plate:txt_carone.value+r.carcardnumber}})}}),_.find(".previous_btn").on("click",function(){d()}),_.find("#txt_carone").on("change",function(){g.save_cache(this.getAttribute("name"),this.getAttribute("data-id")),g.save_cache(this.getAttribute("name")+"_zh",this.value)}),_.find("#txt_carnumber").on("blur",function(){s.regular.is_carNo(this.value)===!1?(s.warning("请填写正确的"+this.getAttribute("placeholder")),s.warning_text(_.find("#txt_carnumber"))):g.save_cache(this.name,this.value),c()},!1),_.one("touchstart",function(){_.removeClass("verify_failed")})}function c(){for(var a=0;a<m.length;a++)if(r(m[a].getAttribute("name").split(",")[0])!==!1&&0==("string"==typeof h[a]?m[a].getAttribute(h[a]):h[a]()))return void _.trigger("is_full_fill",!1);_.trigger("is_full_fill",!0)}var o,d,l=a("page/driver_register_edition/third/select.js"),u=!1,s=a("page/driver_register_edition/tool.js"),f=dd.dialog,g=s.localCache.instance("driver_register_third"),_=t.$container=$(".form_third");t.wakeup=function(a,t,e){o=function(){s.warning.close(),t()},d=function(){s.warning.close(),e()},u===!1&&(u=!0,n(),c())};var p={carprovinceid:"车省号",carcardnumber:"车牌号",carbrandid:"品牌号",cartypeid:"车型号",carcolorid:"车颜色"},v=["carbrandid","cartypeid","carcolorid"];t.check_filed=function(){var a=_.find("#car_type"),t={carprovinceid:_.find("#txt_carone"),carcardnumber:_.find("#txt_carnumber"),carbrandid:a,cartypeid:a,carcolorid:a},e={carprovinceid:t.carprovinceid.attr("data-id"),carcardnumber:t.carcardnumber.val(),carbrandid:a.attr("data-carbrandid"),cartypeid:a.attr("data-cartypeid"),carcolorid:a.attr("data-carcolorid")};for(var i in e)if(r(t[i][0].getAttribute("name").split(",")[0])!==!1){if("carcardnumber"==i){if(s.regular.is_carNo(e[i])===!1)return f.alert("请填写正确"+p[i]||""),!1}else if(0==e[i])return f.alert("请填写正确"+p[i]||""),!1}else delete e[i];return e};var m=[txt_carone,txt_carnumber,car_type],h=["data-id",function(){return s.regular.is_carNo(txt_carnumber.value)},"data-carbrandid"]});
;define("page/driver_register_edition/main.js",function(e){function a(e,a,i){return e[0]==a[0]?(a.show(),void i()):(e.addClass("from_page"),a.addClass("to_page"),$(".main").attr("class","main animate begin_animate"),setTimeout(function(){$(".main").attr("class","main animate end_animate")},0),void setTimeout(function(){e.removeClass("from_page").hide(),a.removeClass("to_page").show(),i()},350))}var i=e("page/driver_register_edition/status/status.js"),t=e("page/driver_register_edition/first/first.js"),r=e("page/driver_register_edition/second/second.js"),n=e("page/driver_register_edition/third/third.js");if(pageParams.usesendurltophone){e("page/driver_register_edition/foot/foot.js")}var s,o,d,g=[t,r,n],h=$(".form"),m=Math.min(Math.max(pageParams.reg_step-1,0),2),_=function(e,t){o=function(a){e<g.length-1?_(e+1,a):e===g.length-1&&location.replace(pageParams.successurl)},d=function(a){e>0&&_(e-1,a)},i.to(e,{}),a(h.eq(m),h.eq(e),function(){g[e].wakeup(t||{},o,d),s=location.hash,location.href="#h"+~~(1e6*Math.random())}),m=e};h.hide(),_(m),addEventListener("hashchange",function(){location.hash===s&&d()});var c=e("page/driver_register_edition/hard_update.js");c.lessThanVersion("3.9.4")&&c.alertUpdate()});
;define("page/driver_register_edition/notice/notice.js",function(){});
;define("page/driver_register_edition/recertification.js",function(e,r){function t(){for(var e=!0,r=0;r<f.length;r++)f[r]||(e=!1);e?g.attr("class","btn-orange recertification_btn"):g.attr("class","btn-gray recertification_btn")}var a=(e("page/driver_register_edition/notice/notice.js"),e("page/driver_register_edition/first/first.js")),i=e("page/driver_register_edition/third/third.js"),n=e("page/driver_register_edition/tool.js");if(pageParams.usesendurltophone){e("page/driver_register_edition/foot/foot.js")}var o=dd.base,c=dd.dialog,d=[];if(d[d.length]=a,"0"!==pageParams.filed_list.driveauthpicurl.display){var l=e("page/driver_register_edition/second/second.js");d[d.length]=l}d[d.length]=i;var s,u=function(){},f=[0,0,0];d.forEach(function(e,r){e.$container.on("is_full_fill",function(e){clearTimeout(s),f[r]=e._args,s=setTimeout(t,100)}),e.wakeup({},u,u)});var g=$(".recertification_btn");r.check_filed=function(){for(var e,r=0,t=[],a={};e=d[r++];){if(!(t=e.check_filed()))return!1;$.extend(a,t)}return a},$(".recertification_btn").on("click",function(){var t=r.check_filed();if(0!=t){var a="车牌：{carbrand} 已注册，请确认车牌是否正确。如仍需注册该车牌，请申诉。";a=a.replace(/\{carbrand\}/,$("#txt_carone").val()+t.carcardnumber);var i={6010:{title:"",text:"该身份证已被注册，如果仍需注册，请进行申诉。",confirm_val:"我要申诉",confirm_url:"http://static.xiaojukeji.com/didialift/hybrid/pages/help/help-accountDatumOQ06.html"},6009:{title:"",text:a,confirm_val:"我要申诉",confirm_url:"http://static.xiaojukeji.com/didialift/hybrid/pages/help/help-accountDatumOQ07.html"}};$.ajax({method:"GET",url:pageParams.reg_url,data:$.extend({step:pageParams.reg_step,token:pageParams.upload_data.token,commit:1},t),success:function(r){var t=o.txtToJson(r);if("102"==t.errno)location.replace(pageParams.gologinurl);else{if("0"!=t.errno&&"3002"!=t.errno)return t.errno in i?void c.confirm({title:i[t.errno].title,text:i[t.errno].text,confirm:{val:i[t.errno].confirm_val,handler:function(){location.href=i[t.errno].confirm_url}}}):c.alert(t.errmsg);e("ddbridge/ddbridge.js").updateDriverAuth({userAuthState:"1",car_auth_state:"1"}),location.replace(pageParams.successurl)}n.closeLoading()},error:function(){c.alert("网络有点不给力，请稍后再试哦~")}}),n.showLoading(),$.ajax({method:"GET",url:pageParams.inviteurl,dataType:"jsonp",data:{plate:txt_carone.value+t.carcardnumber}})}});var _=e("page/driver_register_edition/hard_update.js");_.lessThanVersion("3.9.4")&&_.alertUpdate()});
;define("upload/pinchzoom.js",function(t,i,n){(function(){"use strict";var t=function(t){var i=function(i,n){this.el=t(i),this.zoomFactor=1,this.lastScale=1,this.offset={x:0,y:0},this.options=t.extend({},this.defaults,n),this.setupMarkup(),this.bindEvents(),this.update(),this.enable()},n=function(t,i){return t+i},o=function(t,i){return t>i-.01&&i+.01>t};i.prototype={defaults:{tapZoomFactor:2,zoomOutFactor:1.3,animationDuration:300,animationInterval:5,maxZoom:4,minZoom:.5,lockDragAxis:!1,use2d:!0,zoomStartEventName:"pz_zoomstart",zoomEndEventName:"pz_zoomend",dragStartEventName:"pz_dragstart",dragEndEventName:"pz_dragend",doubleTapEventName:"pz_doubletap"},handleDragStart:function(t){this.el.trigger(this.options.dragStartEventName),this.stopAnimation(),this.lastDragPosition=!1,this.hasInteraction=!0,this.handleDrag(t)},handleDrag:function(t){if(this.zoomFactor>1){var i=this.getTouches(t)[0];this.drag(i,this.lastDragPosition),this.offset=this.sanitizeOffset(this.offset),this.lastDragPosition=i}},handleDragEnd:function(){this.el.trigger(this.options.dragEndEventName),this.end()},handleZoomStart:function(){this.el.trigger(this.options.zoomStartEventName),this.stopAnimation(),this.lastScale=1,this.nthZoom=0,this.lastZoomCenter=!1,this.hasInteraction=!0},handleZoom:function(t,i){var n=this.getTouchCenter(this.getTouches(t)),o=i/this.lastScale;this.lastScale=i,this.nthZoom+=1,this.nthZoom>3&&(this.scale(o,n),this.drag(n,this.lastZoomCenter)),this.lastZoomCenter=n},handleZoomEnd:function(){this.el.trigger(this.options.zoomEndEventName),this.end()},handleDoubleTap:function(t){var i=this.getTouches(t)[0],n=this.zoomFactor>1?1:this.options.tapZoomFactor,o=this.zoomFactor,e=function(t){this.scaleTo(o+t*(n-o),i)}.bind(this);this.hasInteraction||(o>n&&(i=this.getCurrentZoomCenter()),this.animate(this.options.animationDuration,this.options.animationInterval,e,this.swing),this.el.trigger(this.options.doubleTapEventName))},sanitizeOffset:function(t){var i=(this.zoomFactor-1)*this.getContainerX(),n=(this.zoomFactor-1)*this.getContainerY(),o=Math.max(i,0),e=Math.max(n,0),s=Math.min(i,0),a=Math.min(n,0);return{x:Math.min(Math.max(t.x,s),o),y:Math.min(Math.max(t.y,a),e)}},scaleTo:function(t,i){this.scale(t/this.zoomFactor,i)},scale:function(t,i){t=this.scaleZoomFactor(t),this.addOffset({x:(t-1)*(i.x+this.offset.x),y:(t-1)*(i.y+this.offset.y)})},scaleZoomFactor:function(t){var i=this.zoomFactor;return this.zoomFactor*=t,this.zoomFactor=Math.min(this.options.maxZoom,Math.max(this.zoomFactor,this.options.minZoom)),this.zoomFactor/i},drag:function(t,i){i&&this.addOffset(this.options.lockDragAxis?Math.abs(t.x-i.x)>Math.abs(t.y-i.y)?{x:-(t.x-i.x),y:0}:{y:-(t.y-i.y),x:0}:{y:-(t.y-i.y),x:-(t.x-i.x)})},getTouchCenter:function(t){return this.getVectorAvg(t)},getVectorAvg:function(t){return{x:t.map(function(t){return t.x}).reduce(n)/t.length,y:t.map(function(t){return t.y}).reduce(n)/t.length}},addOffset:function(t){this.offset={x:this.offset.x+t.x,y:this.offset.y+t.y}},sanitize:function(){this.zoomFactor<this.options.zoomOutFactor?this.zoomOutAnimation():this.isInsaneOffset(this.offset)&&this.sanitizeOffsetAnimation()},isInsaneOffset:function(t){var i=this.sanitizeOffset(t);return i.x!==t.x||i.y!==t.y},sanitizeOffsetAnimation:function(){var t=this.sanitizeOffset(this.offset),i={x:this.offset.x,y:this.offset.y},n=function(n){this.offset.x=i.x+n*(t.x-i.x),this.offset.y=i.y+n*(t.y-i.y),this.update()}.bind(this);this.animate(this.options.animationDuration,this.options.animationInterval,n,this.swing)},zoomOutAnimation:function(){var t=this.zoomFactor,i=1,n=this.getCurrentZoomCenter(),o=function(o){this.scaleTo(t+o*(i-t),n)}.bind(this);this.animate(this.options.animationDuration,this.options.animationInterval,o,this.swing)},updateAspectRatio:function(){this.setContainerY(this.getContainerX()/this.getAspectRatio())},getInitialZoomFactor:function(){return this.container[0].offsetWidth/this.el[0].offsetWidth},getAspectRatio:function(){return this.el[0].offsetWidth/this.el[0].offsetHeight},getCurrentZoomCenter:function(){var t=this.container[0].offsetWidth*this.zoomFactor,i=this.offset.x,n=t-i-this.container[0].offsetWidth,o=i/n,e=o*this.container[0].offsetWidth/(o+1),s=this.container[0].offsetHeight*this.zoomFactor,a=this.offset.y,h=s-a-this.container[0].offsetHeight,r=a/h,c=r*this.container[0].offsetHeight/(r+1);return 0===n&&(e=this.container[0].offsetWidth),0===h&&(c=this.container[0].offsetHeight),{x:e,y:c}},canDrag:function(){return!o(this.zoomFactor,1)},getTouches:function(t){var i=this.container.offset();return Array.prototype.slice.call(t.touches).map(function(t){return{x:t.pageX-i.left,y:t.pageY-i.top}})},animate:function(t,i,n,o,e){var s=(new Date).getTime(),a=function(){if(this.inAnimation){var h=(new Date).getTime()-s,r=h/t;h>=t?(n(1),e&&e(),this.update(),this.stopAnimation(),this.update()):(o&&(r=o(r)),n(r),this.update(),setTimeout(a,i))}}.bind(this);this.inAnimation=!0,a()},stopAnimation:function(){this.inAnimation=!1},swing:function(t){return-Math.cos(t*Math.PI)/2+.5},getContainerX:function(){return this.container[0].offsetWidth},getContainerY:function(){return this.container[0].offsetHeight},setContainerY:function(t){return this.container.height(t)},setupMarkup:function(){this.container=t('<div class="pinch-zoom-container"></div>'),this.el.before(this.container),this.container.append(this.el),this.container.css({overflow:"hidden",position:"relative"}),this.el.css({"-webkit-transform-origin":"0% 0%","-moz-transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","-o-transform-origin":"0% 0%","transform-origin":"0% 0%",position:"absolute"})},end:function(){this.hasInteraction=!1,this.sanitize(),this.update()},bindEvents:function(){e(this.container.get(0),this),t(window).on("resize",this.update.bind(this)),t(this.el).find("img").on("load",this.update.bind(this))},update:function(){this.updatePlaned||(this.updatePlaned=!0,setTimeout(function(){this.updatePlaned=!1,this.updateAspectRatio();var t=this.getInitialZoomFactor()*this.zoomFactor,i=-this.offset.x/t,n=-this.offset.y/t,o="scale3d("+t+", "+t+",1) translate3d("+i+"px,"+n+"px,0px)",e="scale("+t+", "+t+") translate("+i+"px,"+n+"px)",s=function(){this.clone&&(this.clone.remove(),delete this.clone)}.bind(this);!this.options.use2d||this.hasInteraction||this.inAnimation?(this.is3d=!0,s(),this.el.css({"-webkit-transform":o,"-o-transform":e,"-ms-transform":e,"-moz-transform":e,transform:o})):(this.is3d&&(this.clone=this.el.clone(),this.clone.css("pointer-events","none"),this.clone.appendTo(this.container),setTimeout(s,200)),this.el.css({"-webkit-transform":e,"-o-transform":e,"-ms-transform":e,"-moz-transform":e,transform:e}),this.is3d=!1)}.bind(this),0))},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1}};var e=function(t,i){var n=null,o=0,e=null,s=null,a=function(t,o){if(n!==t){if(n&&!t)switch(n){case"zoom":i.handleZoomEnd(o);break;case"drag":i.handleDragEnd(o)}switch(t){case"zoom":i.handleZoomStart(o);break;case"drag":i.handleDragStart(o)}}n=t},h=function(t){2===o?a("zoom"):1===o&&i.canDrag()?a("drag",t):a(null,t)},r=function(t){return Array.prototype.slice.call(t).map(function(t){return{x:t.pageX,y:t.pageY}})},c=function(t,i){var n,o;return n=t.x-i.x,o=t.y-i.y,Math.sqrt(n*n+o*o)},f=function(t,i){var n=c(t[0],t[1]),o=c(i[0],i[1]);return o/n},u=function(t){t.stopPropagation(),t.preventDefault()},m=function(t){var s=(new Date).getTime();if(o>1&&(e=null),300>s-e)switch(u(t),i.handleDoubleTap(t),n){case"zoom":i.handleZoomEnd(t);break;case"drag":i.handleDragEnd(t)}1===o&&(e=s)},d=!0;t.addEventListener("touchstart",function(t){i.enabled&&(d=!0,o=t.touches.length,m(t))}),t.addEventListener("touchmove",function(t){if(i.enabled){if(d)h(t),n&&u(t),s=r(t.touches);else{switch(n){case"zoom":i.handleZoom(t,f(s,r(t.touches)));break;case"drag":i.handleDrag(t)}n&&(u(t),i.update())}d=!1}}),t.addEventListener("touchend",function(t){i.enabled&&(o=t.touches.length,h(t))})};return i};n.exports=t(window.$)}).call(this)});
;define("upload/clippinchzoom.js",function(t,i,o){var s=t("upload/pinchzoom.js"),a=o.exports=function(){s.apply(this,arguments)};a.prototype=$.extend({},s.prototype,{sanitize:function(){1!=this.zoomFactor&&(this.zoomFactor<this.options.zoomOutFactor?this.zoomOutAnimation():this.isInsaneOffset(this.offset)&&this.sanitizeOffsetAnimation())},canDrag:function(){return!0},handleDrag:function(t){var i=this.getTouches(t)[0];this.drag(i,this.lastDragPosition),this.offset=this.sanitizeOffset(this.offset),this.lastDragPosition=i},sanitizeOffset:function(t){var i=this.options.imgWidth/this.options.imgHeight,o=this.getContainerY(),s=this.getContainerX(),a=(this.zoomFactor-1)*s,n=(this.zoomFactor-1)*o,h=s/o,e=this.options.imgCliper.getViewportRect(),r=e.h,m=e.w;if(1>h)var f=s/i,c=s;else var c=o*i,f=o;var p=(o-r)/2-(o-f)/2*this.zoomFactor;n+=p;var g=(s-m)/2-(s-c)/2*this.zoomFactor;a+=g;var u=Math.max(a,g),z=Math.max(n,p),l=Math.min(a,-g),v=Math.min(n,-p);return{x:Math.min(Math.max(t.x,l),u),y:Math.min(Math.max(t.y,v),z)}}})});
;define("upload/imgcliper.js",function(t,e,i){function n(){function t(t){t=(t||navigator.userAgent).toLowerCase();var e=t.match(/android\s([0-9\.]*)/);return e?e[1]:!1}var e=t();e=e&&e.slice(0,3);var i=navigator.userAgent.match(/(iPhone\sOS)\s([\d_]+)/)||navigator.userAgent.match(/(iPad).*OS\s([\d_]+)/),n=i&&i[2].split("_")[0],o=n>=7||e>4,r=navigator.userAgent;(0===r.indexOf("MQQBrowser/3.4")||r.indexOf("Android 2.3.6")>-1)&&(o=!1);var a=document.createElement("DIV");return a.style["-webkit-transform"]="",a.style["-webkit-transform"]="rotateY(90deg)",""!==a.style["-webkit-transform"]&&o}var o=t("upload/clippinchzoom.js"),r=i.exports=function(t){var e=t.rawData,i=t.onSave;this.rawData=e,this.onSave=i,this.onCancel=t.onCancel||function(){},this.opt=$.extend({},a,t);var r=this.setup(e),h=!n();this.pinchZoom=new o(r,{imgWidth:t.originWidth,imgHeight:t.originHeight,imgCliper:this,use2d:h})},a={barHeight:70,cancel:"取消",confirm:"确定",btnOrder:1,clipWidth:500,clipHeight:500},h=function(t,e){var i=document.createElement(e||"DIV");return i.style.cssText=t.join(";"),i};r.prototype={getViewportRect:function(){var t,e=this,i=innerWidth/innerHeight,n=e.opt.clipWidth/e.opt.clipHeight;t=1>i?n>i?innerWidth:innerHeight*n:i>n?innerHeight*n:innerWidth;var o=t/n;return{w:t,h:o,x:(innerWidth-t)/2,y:(innerHeight-o)/2}},setup:function(t){function e(){clearTimeout(f),f=setTimeout(g,200)}var i=this,n=h(["position: absolute","background-color: rgba(0,0,0,1)","left:0","top:0","z-index: 9998","overflow: hidden"]);n.id="container"+~~(1e6*Math.random());var o=h(["position: absolute","z-index: 1","background-color: rgba(0,0,0,.5)","pointer-events: none"]);o.id="maskTop"+~~(1e6*Math.random());var r=h(["position: absolute","z-index: 1","background-color: rgba(0,0,0,.5)","pointer-events: none"]);r.id="maskbottom"+~~(1e6*Math.random());var a=h(["position: absolute","z-index: 1","box-sizing: border-box","-webkit-box-sizing: border-box","width: "+Math.min(innerWidth,innerHeight)+"px","height: "+Math.min(innerWidth,innerHeight)+"px","border: 1px solid #fff","background-color: transparent","pointer-events: none"]);a.id="viewport"+~~(1e6*Math.random());var d=h(["-webkit-user-drag: none","z-index: 0","-webkit-tap-highlight-color: rgba(0,0,0,0)","position: absolute"],"IMG");d.id="photo"+~~(1e6*Math.random());var s=h(["-webkit-user-drag: none","position: absolute","text-align: center","z-index: 0;"]);s.id="photoFrame"+~~(1e6*Math.random()),d.src=t;var p=h(["text-align: center","color: white","display: inline-block","font-weight: bold","line-height : "+i.opt.barHeight+"px","font-size: 1.8rem"]),l=h(["text-align: center","color: white","display: inline-block","font-weight: bold","font-size: 1.8rem","line-height :"+i.opt.barHeight+"px"]),c=h(["background-color: rgba(0,0,0,0.6)","position: absolute","right: 0","bottom: 0","z-index: 1"]),g=function(){var t=innerWidth/innerHeight,e=i.getViewportRect(),h=e.w,g=e.h;n.style.top=pageYOffset+"px",n.style.left=pageXOffset+"px",s.style.width=n.style.width=innerWidth+"px",s.style.lineHeight=s.style.height=n.style.height=innerHeight+"px",a.style.left=e.x+"px",a.style.top=e.y+"px",a.style.height=g+"px",a.style.width=h+"px",o.style.height=r.style.height=(h===innerWidth?(innerHeight-g)/2:g)+"px",o.style.width=r.style.width=(h===innerWidth?h:(innerWidth-h)/2)+"px",o.style.left=0,o.style.top=0,r.style.bottom=0,r.style.right=0,d.style[1>t?"width":"height"]="100%",d.style[1>t?"height":"width"]="auto",d.style.left=1>t?"0":(innerWidth-i.opt.originWidth/i.opt.originHeight*innerHeight)/2+"px",d.style.top=1>t?(innerHeight-i.opt.originHeight/i.opt.originWidth*innerWidth)/2+"px":"0",c.style[1>t?"height":"width"]=i.opt.barHeight+"px",c.style[1>t?"width":"height"]=(1>t?innerWidth:innerHeight)+"px",p.style[1>t?"height":"width"]=l.style[1>t?"height":"width"]=i.opt.barHeight+"px",p.style[1>t?"width":"height"]=l.style[1>t?"width":"height"]=(1>t?innerWidth:innerHeight)/2+"px"},m=function(t){var e=t.target.tagName?t.target:t.target.parentNode;0===e.id.indexOf("confirm")?i.clipSource():0===e.id.indexOf("cancel")&&(i.onCancel(),i.close())},u=function(t){t.preventDefault(),t.stopPropagation()};g();var f;return s.appendChild(d),l.innerHTML=1==i.opt.btnOrder?i.opt.cancel:i.opt.confirm,p.innerHTML=1==i.opt.btnOrder?i.opt.confirm:i.opt.cancel,l.id=(1===i.opt.btnOrder?"cancel":"confirm")+~~(1e6*Math.random()),p.id=(1===i.opt.btnOrder?"confirm":"cancel")+~~(1e6*Math.random()),c.appendChild(l),c.appendChild(p),n.appendChild(o),n.appendChild(r),n.appendChild(a),n.appendChild(s),n.appendChild(c),document.body.appendChild(n),c.addEventListener("click",m,!1),window.addEventListener("resize",e,!1),window.addEventListener("scroll",e,!1),n.addEventListener("touchmove",u,!1),i.$photo=d,i.$viewport=a,i.$container=n,i.removeOut=function(){n.parentNode.removeChild(n),c.removeEventListener("click",m,!1),window.removeEventListener("resize",e,!1),window.removeEventListener("scroll",e,!1)},s},clipSource:function(){var t=this,e=t.pinchZoom.zoomFactor,i=$(t.$photo).offset(),n=$(t.$viewport).offset(),o={x:n.left-i.left,y:n.top-i.top},r={w:t.opt.clipWidth,h:t.opt.clipHeight},a=t.opt.clipWidth/t.getViewportRect().w;o.x*=a,o.y*=a;var h=document.createElement("CANVAS"),d=h.getContext("2d");if(h.width=r.w,h.height=r.h,d.drawImage(t.$photo,-o.x,-o.y,t.$photo.width*e*a,t.$photo.height*e*a),"image/png"===t.opt.fileType)var s=h.toDataURL("image/png");else var s=h.toDataURL("image/jpeg");t.onSave(s)},openImage:function(t){var e=window.open("about:blank","runWindow");e.opener=null,e.document.open(),e.document.write('<img src="'+t+'" />'),e.document.close()},show:function(t){if(t){var e=t.rawData;e&&(this.rawData=e,this.$photo.src=t.rawData),t.onSave&&(this.onSave=t.onSave),this.opt=$.extend({},a,t),this.pinchZoom.offset={x:0,y:0},this.pinchZoom.zoomFactor=1}this.$container.style.display="block"},close:function(){this.$container.style.display="none",this.destroy()},destroy:function(){this.removeOut();for(var t in this)this.hasOwnProperty(t)&&delete this[t];this.destroy=function(){}}}});
;var BinaryFile=function(e,t,n){var r=e,o=t||0,a=0;this.getRawData=function(){return r},"string"==typeof e?(a=n||r.length,this.getByteAt=function(e){return 255&r.charCodeAt(e+o)},this.getBytesAt=function(e,t){for(var n=[],a=0;t>a;a++)n[a]=255&r.charCodeAt(e+a+o);return n}):"unknown"==typeof e&&(a=n||IEBinary_getLength(r),this.getByteAt=function(e){return IEBinary_getByteAt(r,e+o)},this.getBytesAt=function(e,t){return new VBArray(IEBinary_getBytesAt(r,e+o,t)).toArray()}),this.getLength=function(){return a},this.getSByteAt=function(e){var t=this.getByteAt(e);return t>127?t-256:t},this.getShortAt=function(e,t){var n=t?(this.getByteAt(e)<<8)+this.getByteAt(e+1):(this.getByteAt(e+1)<<8)+this.getByteAt(e);return 0>n&&(n+=65536),n},this.getSShortAt=function(e,t){var n=this.getShortAt(e,t);return n>32767?n-65536:n},this.getLongAt=function(e,t){var n=this.getByteAt(e),r=this.getByteAt(e+1),o=this.getByteAt(e+2),a=this.getByteAt(e+3),i=t?(((n<<8)+r<<8)+o<<8)+a:(((a<<8)+o<<8)+r<<8)+n;return 0>i&&(i+=4294967296),i},this.getSLongAt=function(e,t){var n=this.getLongAt(e,t);return n>2147483647?n-4294967296:n},this.getStringAt=function(e,t){for(var n=[],r=this.getBytesAt(e,t),o=0;t>o;o++)n[o]=String.fromCharCode(r[o]);return n.join("")},this.getCharAt=function(e){return String.fromCharCode(this.getByteAt(e))},this.toBase64=function(){return window.btoa(r)},this.fromBase64=function(e){r=window.atob(e)}},BinaryAjax=function(){function e(){var e=null;return window.ActiveXObject?e=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(e=new XMLHttpRequest),e}function t(t,n,r){var o=e();o?(n&&("undefined"!=typeof o.onload?o.onload=function(){"200"==o.status?n(this):r&&r(),o=null}:o.onreadystatechange=function(){4==o.readyState&&("200"==o.status?n(this):r&&r(),o=null)}),o.open("HEAD",t,!0),o.send(null)):r&&r()}function n(t,n,r,o,a,i){var s=e();if(s){var u=0;o&&!a&&(u=o[0]);var c=0;o&&(c=o[1]-o[0]+1),n&&("undefined"!=typeof s.onload?s.onload=function(){"200"==s.status||"206"==s.status||"0"==s.status?(s.binaryResponse=new BinaryFile(s.responseText,u,c),s.fileSize=i||s.getResponseHeader("Content-Length"),n(s)):r&&r(),s=null}:s.onreadystatechange=function(){if(4==s.readyState){if("200"==s.status||"206"==s.status||"0"==s.status){var e={status:s.status,binaryResponse:new BinaryFile("unknown"==typeof s.responseBody?s.responseBody:s.responseText,u,c),fileSize:i||s.getResponseHeader("Content-Length")};n(e)}else r&&r();s=null}}),s.open("GET",t,!0),s.overrideMimeType&&s.overrideMimeType("text/plain; charset=x-user-defined"),o&&a&&s.setRequestHeader("Range","bytes="+o[0]+"-"+o[1]),s.setRequestHeader("If-Modified-Since","Sat, 1 Jan 1970 00:00:00 GMT"),s.send(null)}else r&&r()}return function(e,r,o,a){a?t(e,function(t){var i,s,u=parseInt(t.getResponseHeader("Content-Length"),10),c=t.getResponseHeader("Accept-Ranges");i=a[0],a[0]<0&&(i+=u),s=i+a[1]-1,n(e,r,o,[i,s],"bytes"==c,u)}):n(e,r,o)}}();document.write("<script type='text/vbscript'>\r\nFunction IEBinary_getByteAt(strBinary, iOffset)\r\n	IEBinary_getByteAt = AscB(MidB(strBinary, iOffset + 1, 1))\r\nEnd Function\r\nFunction IEBinary_getBytesAt(strBinary, iOffset, iLength)\r\n  Dim aBytes()\r\n  ReDim aBytes(iLength - 1)\r\n  For i = 0 To iLength - 1\r\n   aBytes(i) = IEBinary_getByteAt(strBinary, iOffset + i)\r\n  Next\r\n  IEBinary_getBytesAt = aBytes\r\nEnd Function\r\nFunction IEBinary_getLength(strBinary)\r\n	IEBinary_getLength = LenB(strBinary)\r\nEnd Function\r\n</script>\r\n");var EXIF=function(){function e(e){return!!e.exifdata}function t(e,t){BinaryAjax(e.src,function(r){var o=n(r.binaryResponse);e.exifdata=o||{},t&&t.call(e)})}function n(e){if(255!=e.getByteAt(0)||216!=e.getByteAt(1))return!1;for(var t,n=2,r=e.getLength();r>n;){if(255!=e.getByteAt(n))return l&&console.log("Not a valid marker at offset "+n+", found: "+e.getByteAt(n)),!1;if(t=e.getByteAt(n+1),22400==t)return l&&console.log("Found 0xFFE1 marker"),a(e,n+4,e.getShortAt(n+2,!0)-2);if(225==t)return l&&console.log("Found 0xFFE1 marker"),a(e,n+4,e.getShortAt(n+2,!0)-2);n+=2+e.getShortAt(n+2,!0)}}function r(e,t,n,r,a){var i,s,u,c=e.getShortAt(n,a),d={};for(u=0;c>u;u++)i=n+12*u+2,s=r[e.getShortAt(i,a)],!s&&l&&console.log("Unknown tag: "+e.getShortAt(i,a)),d[s]=o(e,i,t,n,a);return d}function o(e,t,n,r,o){var a,i,s,u,c,d,l=e.getShortAt(t+2,o),g=e.getLongAt(t+4,o),h=e.getLongAt(t+8,o)+n;switch(l){case 1:case 7:if(1==g)return e.getByteAt(t+8,o);for(a=g>4?h:t+8,i=[],u=0;g>u;u++)i[u]=e.getByteAt(a+u);return i;case 2:return a=g>4?h:t+8,e.getStringAt(a,g-1);case 3:if(1==g)return e.getShortAt(t+8,o);for(a=g>2?h:t+8,i=[],u=0;g>u;u++)i[u]=e.getShortAt(a+2*u,o);return i;case 4:if(1==g)return e.getLongAt(t+8,o);i=[];for(var u=0;g>u;u++)i[u]=e.getLongAt(h+4*u,o);return i;case 5:if(1==g)return c=e.getLongAt(h,o),d=e.getLongAt(h+4,o),s=new Number(c/d),s.numerator=c,s.denominator=d,s;for(i=[],u=0;g>u;u++)c=e.getLongAt(h+8*u,o),d=e.getLongAt(h+4+8*u,o),i[u]=new Number(c/d),i[u].numerator=c,i[u].denominator=d;return i;case 9:if(1==g)return e.getSLongAt(t+8,o);for(i=[],u=0;g>u;u++)i[u]=e.getSLongAt(h+4*u,o);return i;case 10:if(1==g)return e.getSLongAt(h,o)/e.getSLongAt(h+4,o);for(i=[],u=0;g>u;u++)i[u]=e.getSLongAt(h+8*u,o)/e.getSLongAt(h+4+8*u,o);return i}}function a(e,t){if("Exif"!=e.getStringAt(t,4))return l&&console.log("Not valid EXIF data! "+e.getStringAt(t,4)),!1;var n,o,a,i,s,u=t+6;if(18761==e.getShortAt(u))n=!1;else{if(19789!=e.getShortAt(u))return l&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;n=!0}if(42!=e.getShortAt(u+2,n))return l&&console.log("Not valid TIFF data! (no 0x002A)"),!1;if(8!=e.getLongAt(u+4,n))return l&&console.log("Not valid TIFF data! (First offset not 8)",e.getShortAt(u+4,n)),!1;if(o=r(e,u,u+8,h,n),o.ExifIFDPointer){i=r(e,u,u+o.ExifIFDPointer,g,n);for(a in i){switch(a){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":i[a]=p[a][i[a]];break;case"ExifVersion":case"FlashpixVersion":i[a]=String.fromCharCode(i[a][0],i[a][1],i[a][2],i[a][3]);break;case"ComponentsConfiguration":i[a]=p.Components[i[a][0]]+p.Components[i[a][1]]+p.Components[i[a][2]]+p.Components[i[a][3]]}o[a]=i[a]}}if(o.GPSInfoIFDPointer){s=r(e,u,u+o.GPSInfoIFDPointer,f,n);for(a in s){switch(a){case"GPSVersionID":s[a]=s[a][0]+"."+s[a][1]+"."+s[a][2]+"."+s[a][3]}o[a]=s[a]}}return o}function i(n,r){return n.complete?(e(n)?r&&r.call(n):t(n,r),!0):!1}function s(t,n){return e(t)?t.exifdata[n]:void 0}function u(t){if(!e(t))return{};var n,r=t.exifdata,o={};for(n in r)r.hasOwnProperty(n)&&(o[n]=r[n]);return o}function c(t){if(!e(t))return"";var n,r=t.exifdata,o="";for(n in r)r.hasOwnProperty(n)&&(o+="object"==typeof r[n]?r[n]instanceof Number?n+" : "+r[n]+" ["+r[n].numerator+"/"+r[n].denominator+"]\r\n":n+" : ["+r[n].length+" values]\r\n":n+" : "+r[n]+"\r\n");return o}function d(e){return n(e)}var l=!1,g={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},h={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},f={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},p={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};return{readFromBinaryFile:d,pretty:c,getTag:s,getAllTags:u,getData:i,Tags:g,TiffTags:h,GPSTags:f,StringValues:p}}();!function(e){function t(e,t){this.file=e,this.options=r.extend({},o,t),this._defaults=o,this._name=n,this.init()}var n="canvasResize",r={newsize:function(e,t,n,r,o){var a=o?"h":"";if(n&&e>n||r&&t>r){var i=e/t;(i>=1||0===r)&&n&&!o?(e=n,t=n/i>>0):o&&n/r>=i?(e=n,t=n/i>>0,a="w"):(e=r*i>>0,t=r)}return{width:e,height:t,cropped:a}},dataURLtoBlob:function(e){for(var t=e.split(",")[0].split(":")[1].split(";")[0],n=atob(e.split(",")[1]),r=new ArrayBuffer(n.length),o=new Uint8Array(r),a=0;a<n.length;a++)o[a]=n.charCodeAt(a);var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;return i?(i=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder),i.append(r),i.getBlob(t)):i=new Blob([r],{type:t})},detectSubsampling:function(e){var t=e.width,n=e.height;if(t*n>1048576){var r=document.createElement("canvas");r.width=r.height=1;var o=r.getContext("2d");return o.drawImage(e,-t+1,0),0===o.getImageData(0,0,1,1).data[3]}return!1},rotate:function(e,t){var n={1:{90:6,180:3,270:8},2:{90:7,180:4,270:5},3:{90:8,180:1,270:6},4:{90:5,180:2,270:7},5:{90:2,180:7,270:4},6:{90:3,180:8,270:1},7:{90:4,180:5,270:2},8:{90:1,180:6,270:3}};return n[e][t]?n[e][t]:e},transformCoordinate:function(e,t,n,r){switch(r){case 5:case 6:case 7:case 8:e.width=n,e.height=t;break;default:e.width=t,e.height=n}var o=e.getContext("2d");switch(r){case 1:break;case 2:o.translate(t,0),o.scale(-1,1);break;case 3:o.translate(t,n),o.rotate(Math.PI);break;case 4:o.translate(0,n),o.scale(1,-1);break;case 5:o.rotate(.5*Math.PI),o.scale(1,-1);break;case 6:o.rotate(.5*Math.PI),o.translate(0,-n);break;case 7:o.rotate(.5*Math.PI),o.translate(t,-n),o.scale(-1,1);break;case 8:o.rotate(-.5*Math.PI),o.translate(-t,0)}},detectVerticalSquash:function(e,t,n){var r=document.createElement("canvas");r.width=1,r.height=n;var o=r.getContext("2d");o.drawImage(e,0,0);for(var a=o.getImageData(0,0,1,n).data,i=0,s=n,u=n;u>i;){var c=a[4*(u-1)+3];0===c?s=u:i=u,u=s+i>>1}var d=u/n;return 0===d?1:d},callback:function(e){return e},extend:function(){var e=arguments[0]||{},t=1,n=arguments.length,o=!1;e.constructor===Boolean&&(o=e,e=arguments[1]||{}),1===n&&(e=this,t=0);for(var a;n>t;t++)if(null!==(a=arguments[t]))for(var i in a)e!==a[i]&&(o&&"object"==typeof a[i]&&e[i]?r.extend(e[i],a[i]):void 0!==a[i]&&(e[i]=a[i]));return e}},o={width:300,height:0,crop:!1,quality:80,rotate:0,callback:r.callback};t.prototype={init:function(){function e(e){var o=atob(e.split(",")[1]),a=new BinaryFile(o,0,o.length),i=EXIF.readFromBinaryFile(a),s=new Image;s.onload=function(){var e=i.Orientation||1;e=r.rotate(e,t.options.rotate);var o=e>=5&&8>=e?r.newsize(s.height,s.width,t.options.width,t.options.height,t.options.crop):r.newsize(s.width,s.height,t.options.width,t.options.height,t.options.crop),a=s.width,u=s.height,c=o.width,d=o.height,l=document.createElement("canvas"),g=l.getContext("2d");g.save(),r.transformCoordinate(l,c,d,e),r.detectSubsampling(s)&&(a/=2,u/=2);var h=1024,f=document.createElement("canvas");f.width=f.height=h;for(var p=f.getContext("2d"),S=r.detectVerticalSquash(s,a,u),m=0;u>m;){for(var y=m+h>u?u-m:h,A=0;a>A;){var w=A+h>a?a-A:h;p.clearRect(0,0,h,h),p.drawImage(s,-A,-m);var B=Math.floor(A*c/a),v=Math.ceil(w*c/a),F=Math.floor(m*d/u/S),P=Math.ceil(y*d/u/S);g.drawImage(f,0,0,w,y,B,F,v,P),A+=h}m+=h}g.restore(),f=p=null;var C=document.createElement("canvas");C.width="h"===o.cropped?d:c,C.height="w"===o.cropped?c:d;var b="h"===o.cropped?.5*(d-c):0,D="w"===o.cropped?.5*(c-d):0;if(newctx=C.getContext("2d"),newctx.drawImage(l,b,D,c,d),n.type||t.options.fileType,"image/png"===n.type)var I=C.toDataURL(n.type);else var I=C.toDataURL("image/jpeg",.01*t.options.quality);t.options.callback(I,C.width,C.height)},s.src=e}var t=this,n=this.file;if(n instanceof File){var o=new FileReader;o.onloadend=function(t){var n=t.target.result;e(n)},o.readAsDataURL(n)}else e(n.dataURL)}},e[n]=function(e,n){return"string"==typeof e?r[e](n):void new t(e,n)}}(window);
;define("upload/upload.js",function(t,e,i){var o=t("upload/imgcliper.js"),n=[/UCBrowser\/10\.6\.0\.620/i],a=i.exports=function(t,e){for(var i=0;i<n.length;i++)n[i].exec(navigator.userAgent)&&alert("发现您当前使用的浏览器上传图片有故障。\n请尝试更换浏览器访问本页");var o="iframepost"+Math.floor(1e3*Math.random()),a=e.filekey||"file";this.opt=$.extend({outputWidth:500,outputHeight:500,data:{}},e),this.$el=t,this.fileInput=document.createElement("INPUT"),this.form=document.createElement("FORM"),this.iframe=document.createElement("IFRAME"),this.fileInput.name=a,this.fileInput.type="file",this.fileInput.setAttribute("accept","image/*"),this.fileInput.style.cssText="position: absolute;left:0;top:0;height:100%;width:100%; opacity: 0",this.form.target=o,this.form.method="POST",this.form.encoding="multipart/form-data",this.form.action=e.url,"undefined"==typeof FileReader&&(alert("非常抱歉，您的手机不支持文件上传，请更换手机注册，谢谢"),this.iframe.style.display="none",this.iframe.name=o,document.body.appendChild(this.iframe)),this.form.appendChild(this.fileInput),t.appendChild(this.form),this.register()};a.prototype={register:function(){var t=this;this.fileInput.addEventListener("change",function(e){t.onFileChange(e)},!1),this.iframe&&this.iframe.addEventListener("load",function(){t.onsuccess(this.contentWindow.document.body.innerHTML)},!1)},onFileChange:function(t){function e(t){t=void 0===t?!0:t,i.showLoading();var e=Math.max(Math.max(i.opt.outputWidth,i.opt.outputHeight),100);canvasResize(o,{width:e,height:e,crop:!1,quality:80,rotate:0,callback:function(e,o,n){i.closeLoading(),t?i.clip(e,o,n):(i.showLoading(),i.compress({dataURL:data},function(t){i.upload(t)}),i.fileInput.value="")}})}var i=this,o=t.target.files[0];if(void 0!==o){var n=t.target.value.match(/\.(png|jpg|jpeg|gif)$/i)[1];this.fileInfo={ext:n,type:o.type,name:o.name,size:o.size},i.opt.onFileSelect?i.opt.onFileSelect(t,e):e()}},clip:function(t,e,i){var n=this,a={clipWidth:n.opt.outputWidth,clipHeight:n.opt.outputHeight,originHeight:i,originWidth:e,fileType:n.fileInfo.type,rawData:t,onSave:function(t){n.showLoading(),n.compress({dataURL:t},function(t){n.upload(t)}),n.fileInput.value=""},onCancel:function(){n.fileInput.value="",n.opt.onCancelUpload&&n.opt.onCancelUpload()}};this.imgCliper&&this.imgCliper.destroy(),this.imgCliper=new o(a)},compress:function(t,e){var i=this;canvasResize(t,{fileType:i.fileInfo.type,width:i.opt.outputWidth,height:i.opt.outputHeight,crop:!1,quality:80,rotate:0,callback:function(t){e(t)}})},upload:function(t){var e=this,i=new FormData;i.append("file",t),i.append("type",e.fileInfo.type),i.append("size",e.fileInfo.size),i.append("filename",e.fileInfo.name),i.append("ext",e.fileInfo.ext),$.each(e.opt.data,function(t,e){i.append(t,e)}),i.append("filename",e.fileInfo.name+~~(1e6*Math.random()));var o=new XMLHttpRequest;o.open("POST",e.opt.url,!0),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("pragma","no-cache"),o.upload.addEventListener("progress",function(t){t.lengthComputable;Math.ceil(t.loaded/t.total*100)},!1),o.onreadystatechange=function(){4===o.readyState&&(clearTimeout(n),200===o.status?e.onUploadSuccess(o.responseText):e.uploadFailed(o.responseText))};var n=setTimeout(function(){o.abort(),e.uploadFailed("timeout")},e.opt.timeout||6e4);o.send(i)},onUploadSuccess:function(t){this.imgCliper.close(),this.closeLoading(),this.opt.onSuccessUpload&&this.opt.onSuccessUpload(t)},uploadFailed:function(){this.opt.onFailedUpload&&this.opt.onFailedUpload()},showLoading:function(){window.dd&&window.dd.dialog&&window.dd.dialog.loading("正在加载",this.opt.timeout||6e4)},closeLoading:function(){window.dd&&window.dd.dialog&&window.dd.dialog.loading("正在加载",0)}}});
;var BinaryFile=function(t,e,n){var r=t,i=e||0,s=0;this.getRawData=function(){return r},"string"==typeof t?(s=n||r.length,this.getByteAt=function(t){return 255&r.charCodeAt(t+i)},this.getBytesAt=function(t,e){for(var n=[],s=0;e>s;s++)n[s]=255&r.charCodeAt(t+s+i);return n}):"unknown"==typeof t&&(s=n||IEBinary_getLength(r),this.getByteAt=function(t){return IEBinary_getByteAt(r,t+i)},this.getBytesAt=function(t,e){return new VBArray(IEBinary_getBytesAt(r,t+i,e)).toArray()}),this.getLength=function(){return s},this.getSByteAt=function(t){var e=this.getByteAt(t);return e>127?e-256:e},this.getShortAt=function(t,e){var n=e?(this.getByteAt(t)<<8)+this.getByteAt(t+1):(this.getByteAt(t+1)<<8)+this.getByteAt(t);return 0>n&&(n+=65536),n},this.getSShortAt=function(t,e){var n=this.getShortAt(t,e);return n>32767?n-65536:n},this.getLongAt=function(t,e){var n=this.getByteAt(t),r=this.getByteAt(t+1),i=this.getByteAt(t+2),s=this.getByteAt(t+3),o=e?(((n<<8)+r<<8)+i<<8)+s:(((s<<8)+i<<8)+r<<8)+n;return 0>o&&(o+=4294967296),o},this.getSLongAt=function(t,e){var n=this.getLongAt(t,e);return n>2147483647?n-4294967296:n},this.getStringAt=function(t,e){for(var n=[],r=this.getBytesAt(t,e),i=0;e>i;i++)n[i]=String.fromCharCode(r[i]);return n.join("")},this.getCharAt=function(t){return String.fromCharCode(this.getByteAt(t))},this.toBase64=function(){return window.btoa(r)},this.fromBase64=function(t){r=window.atob(t)}},BinaryAjax=function(){function t(){var t=null;return window.ActiveXObject?t=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(t=new XMLHttpRequest),t}function e(e,n,r){var i=t();i?(n&&("undefined"!=typeof i.onload?i.onload=function(){"200"==i.status?n(this):r&&r(),i=null}:i.onreadystatechange=function(){4==i.readyState&&("200"==i.status?n(this):r&&r(),i=null)}),i.open("HEAD",e,!0),i.send(null)):r&&r()}function n(e,n,r,i,s,o){var a=t();if(a){var u=0;i&&!s&&(u=i[0]);var y=0;i&&(y=i[1]-i[0]+1),n&&("undefined"!=typeof a.onload?a.onload=function(){"200"==a.status||"206"==a.status||"0"==a.status?(a.binaryResponse=new BinaryFile(a.responseText,u,y),a.fileSize=o||a.getResponseHeader("Content-Length"),n(a)):r&&r(),a=null}:a.onreadystatechange=function(){if(4==a.readyState){if("200"==a.status||"206"==a.status||"0"==a.status){var t={status:a.status,binaryResponse:new BinaryFile("unknown"==typeof a.responseBody?a.responseBody:a.responseText,u,y),fileSize:o||a.getResponseHeader("Content-Length")};n(t)}else r&&r();a=null}}),a.open("GET",e,!0),a.overrideMimeType&&a.overrideMimeType("text/plain; charset=x-user-defined"),i&&s&&a.setRequestHeader("Range","bytes="+i[0]+"-"+i[1]),a.setRequestHeader("If-Modified-Since","Sat, 1 Jan 1970 00:00:00 GMT"),a.send(null)}else r&&r()}return function(t,r,i,s){s?e(t,function(e){var o,a,u=parseInt(e.getResponseHeader("Content-Length"),10),y=e.getResponseHeader("Accept-Ranges");o=s[0],s[0]<0&&(o+=u),a=o+s[1]-1,n(t,r,i,[o,a],"bytes"==y,u)}):n(t,r,i)}}();document.write("<script type='text/vbscript'>\r\nFunction IEBinary_getByteAt(strBinary, iOffset)\r\n	IEBinary_getByteAt = AscB(MidB(strBinary, iOffset + 1, 1))\r\nEnd Function\r\nFunction IEBinary_getBytesAt(strBinary, iOffset, iLength)\r\n  Dim aBytes()\r\n  ReDim aBytes(iLength - 1)\r\n  For i = 0 To iLength - 1\r\n   aBytes(i) = IEBinary_getByteAt(strBinary, iOffset + i)\r\n  Next\r\n  IEBinary_getBytesAt = aBytes\r\nEnd Function\r\nFunction IEBinary_getLength(strBinary)\r\n	IEBinary_getLength = LenB(strBinary)\r\nEnd Function\r\n</script>\r\n");
;!function(t){function e(t,e){this.file=t,this.options=r.extend({},n,e),this._defaults=n,this._name=a,this.init()}var a="canvasResize",r={newsize:function(t,e,a,r,n){var i=n?"h":"";if(a&&t>a||r&&e>r){var o=t/e;(o>=1||0===r)&&a&&!n?(t=a,e=a/o>>0):n&&a/r>=o?(t=a,e=a/o>>0,i="w"):(t=r*o>>0,e=r)}return{width:t,height:e,cropped:i}},dataURLtoBlob:function(t){for(var e=t.split(",")[0].split(":")[1].split(";")[0],a=atob(t.split(",")[1]),r=new ArrayBuffer(a.length),n=new Uint8Array(r),i=0;i<a.length;i++)n[i]=a.charCodeAt(i);var o=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;return o?(o=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder),o.append(r),o.getBlob(e)):o=new Blob([r],{type:e})},detectSubsampling:function(t){var e=t.width,a=t.height;if(e*a>1048576){var r=document.createElement("canvas");r.width=r.height=1;var n=r.getContext("2d");return n.drawImage(t,-e+1,0),0===n.getImageData(0,0,1,1).data[3]}return!1},rotate:function(t,e){var a={1:{90:6,180:3,270:8},2:{90:7,180:4,270:5},3:{90:8,180:1,270:6},4:{90:5,180:2,270:7},5:{90:2,180:7,270:4},6:{90:3,180:8,270:1},7:{90:4,180:5,270:2},8:{90:1,180:6,270:3}};return a[t][e]?a[t][e]:t},transformCoordinate:function(t,e,a,r){switch(r){case 5:case 6:case 7:case 8:t.width=a,t.height=e;break;default:t.width=e,t.height=a}var n=t.getContext("2d");switch(r){case 1:break;case 2:n.translate(e,0),n.scale(-1,1);break;case 3:n.translate(e,a),n.rotate(Math.PI);break;case 4:n.translate(0,a),n.scale(1,-1);break;case 5:n.rotate(.5*Math.PI),n.scale(1,-1);break;case 6:n.rotate(.5*Math.PI),n.translate(0,-a);break;case 7:n.rotate(.5*Math.PI),n.translate(e,-a),n.scale(-1,1);break;case 8:n.rotate(-.5*Math.PI),n.translate(-e,0)}},detectVerticalSquash:function(t,e,a){var r=document.createElement("canvas");r.width=1,r.height=a;var n=r.getContext("2d");n.drawImage(t,0,0);for(var i=n.getImageData(0,0,1,a).data,o=0,c=a,s=a;s>o;){var h=i[4*(s-1)+3];0===h?c=s:o=s,s=c+o>>1}var l=s/a;return 0===l?1:l},callback:function(t){return t},extend:function(){var t=arguments[0]||{},e=1,a=arguments.length,n=!1;t.constructor===Boolean&&(n=t,t=arguments[1]||{}),1===a&&(t=this,e=0);for(var i;a>e;e++)if(null!==(i=arguments[e]))for(var o in i)t!==i[o]&&(n&&"object"==typeof i[o]&&t[o]?r.extend(t[o],i[o]):void 0!==i[o]&&(t[o]=i[o]));return t}},n={width:300,height:0,crop:!1,quality:80,rotate:0,callback:r.callback};e.prototype={init:function(){function t(t){var n=atob(t.split(",")[1]),i=new BinaryFile(n,0,n.length),o=EXIF.readFromBinaryFile(i),c=new Image;c.onload=function(){var t=o.Orientation||1;t=r.rotate(t,e.options.rotate);var n=t>=5&&8>=t?r.newsize(c.height,c.width,e.options.width,e.options.height,e.options.crop):r.newsize(c.width,c.height,e.options.width,e.options.height,e.options.crop),i=c.width,s=c.height,h=n.width,l=n.height,d=document.createElement("canvas"),w=d.getContext("2d");w.save(),r.transformCoordinate(d,h,l,t),r.detectSubsampling(c)&&(i/=2,s/=2);var u=1024,g=document.createElement("canvas");g.width=g.height=u;for(var p=g.getContext("2d"),v=r.detectVerticalSquash(c,i,s),f=0;s>f;){for(var m=f+u>s?s-f:u,b=0;i>b;){var B=b+u>i?i-b:u;p.clearRect(0,0,u,u),p.drawImage(c,-b,-f);var y=Math.floor(b*h/i),I=Math.ceil(B*h/i),k=Math.floor(f*l/s/v),x=Math.ceil(m*l/s/v);w.drawImage(g,0,0,B,m,y,k,I,x),b+=u}f+=u}w.restore(),g=p=null;var M=document.createElement("canvas");M.width="h"===n.cropped?l:h,M.height="w"===n.cropped?h:l;var C="h"===n.cropped?.5*(l-h):0,R="w"===n.cropped?.5*(h-l):0;newctx=M.getContext("2d"),newctx.drawImage(d,C,R,h,l);a.type||e.options.fileType;if("image/png"===a.type)var z=M.toDataURL(a.type);else var z=M.toDataURL("image/jpeg",.01*e.options.quality);e.options.callback(z,M.width,M.height)},c.src=t}var e=this,a=this.file;if(a instanceof File){var n=new FileReader;n.onloadend=function(e){var a=e.target.result;t(a)},n.readAsDataURL(a)}else t(a.dataURL)}},t[a]=function(t,a){return"string"==typeof t?r[t](a):void new e(t,a)}}(window);
;var EXIF=function(){function e(e){return!!e.exifdata}function t(e,t){BinaryAjax(e.src,function(o){var n=r(o.binaryResponse);e.exifdata=n||{},t&&t.call(e)})}function r(e){if(255!=e.getByteAt(0)||216!=e.getByteAt(1))return!1;for(var t,r=2,o=e.getLength();o>r;){if(255!=e.getByteAt(r))return c&&console.log("Not a valid marker at offset "+r+", found: "+e.getByteAt(r)),!1;if(t=e.getByteAt(r+1),22400==t)return c&&console.log("Found 0xFFE1 marker"),i(e,r+4,e.getShortAt(r+2,!0)-2);if(225==t)return c&&console.log("Found 0xFFE1 marker"),i(e,r+4,e.getShortAt(r+2,!0)-2);r+=2+e.getShortAt(r+2,!0)}}function o(e,t,r,o,i){var a,s,u,l=e.getShortAt(r,i),d={};for(u=0;l>u;u++)a=r+12*u+2,s=o[e.getShortAt(a,i)],!s&&c&&console.log("Unknown tag: "+e.getShortAt(a,i)),d[s]=n(e,a,t,r,i);return d}function n(e,t,r,o,n){var i,a,s,u,l,d,c=e.getShortAt(t+2,n),g=e.getLongAt(t+4,n),S=e.getLongAt(t+8,n)+r;switch(c){case 1:case 7:if(1==g)return e.getByteAt(t+8,n);for(i=g>4?S:t+8,a=[],u=0;g>u;u++)a[u]=e.getByteAt(i+u);return a;case 2:return i=g>4?S:t+8,e.getStringAt(i,g-1);case 3:if(1==g)return e.getShortAt(t+8,n);for(i=g>2?S:t+8,a=[],u=0;g>u;u++)a[u]=e.getShortAt(i+2*u,n);return a;case 4:if(1==g)return e.getLongAt(t+8,n);a=[];for(var u=0;g>u;u++)a[u]=e.getLongAt(S+4*u,n);return a;case 5:if(1==g)return l=e.getLongAt(S,n),d=e.getLongAt(S+4,n),s=new Number(l/d),s.numerator=l,s.denominator=d,s;for(a=[],u=0;g>u;u++)l=e.getLongAt(S+8*u,n),d=e.getLongAt(S+4+8*u,n),a[u]=new Number(l/d),a[u].numerator=l,a[u].denominator=d;return a;case 9:if(1==g)return e.getSLongAt(t+8,n);for(a=[],u=0;g>u;u++)a[u]=e.getSLongAt(S+4*u,n);return a;case 10:if(1==g)return e.getSLongAt(S,n)/e.getSLongAt(S+4,n);for(a=[],u=0;g>u;u++)a[u]=e.getSLongAt(S+8*u,n)/e.getSLongAt(S+4+8*u,n);return a}}function i(e,t){if("Exif"!=e.getStringAt(t,4))return c&&console.log("Not valid EXIF data! "+e.getStringAt(t,4)),!1;var r,n,i,a,s,u=t+6;if(18761==e.getShortAt(u))r=!1;else{if(19789!=e.getShortAt(u))return c&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;r=!0}if(42!=e.getShortAt(u+2,r))return c&&console.log("Not valid TIFF data! (no 0x002A)"),!1;if(8!=e.getLongAt(u+4,r))return c&&console.log("Not valid TIFF data! (First offset not 8)",e.getShortAt(u+4,r)),!1;if(n=o(e,u,u+8,S,r),n.ExifIFDPointer){a=o(e,u,u+n.ExifIFDPointer,g,r);for(i in a){switch(i){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":a[i]=h[i][a[i]];break;case"ExifVersion":case"FlashpixVersion":a[i]=String.fromCharCode(a[i][0],a[i][1],a[i][2],a[i][3]);break;case"ComponentsConfiguration":a[i]=h.Components[a[i][0]]+h.Components[a[i][1]]+h.Components[a[i][2]]+h.Components[a[i][3]]}n[i]=a[i]}}if(n.GPSInfoIFDPointer){s=o(e,u,u+n.GPSInfoIFDPointer,f,r);for(i in s){switch(i){case"GPSVersionID":s[i]=s[i][0]+"."+s[i][1]+"."+s[i][2]+"."+s[i][3]}n[i]=s[i]}}return n}function a(r,o){return r.complete?(e(r)?o&&o.call(r):t(r,o),!0):!1}function s(t,r){return e(t)?t.exifdata[r]:void 0}function u(t){if(!e(t))return{};var r,o=t.exifdata,n={};for(r in o)o.hasOwnProperty(r)&&(n[r]=o[r]);return n}function l(t){if(!e(t))return"";var r,o=t.exifdata,n="";for(r in o)o.hasOwnProperty(r)&&(n+="object"==typeof o[r]?o[r]instanceof Number?r+" : "+o[r]+" ["+o[r].numerator+"/"+o[r].denominator+"]\r\n":r+" : ["+o[r].length+" values]\r\n":r+" : "+o[r]+"\r\n");return n}function d(e){return r(e)}var c=!1,g={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},S={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},f={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},h={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};return{readFromBinaryFile:d,pretty:l,getTag:s,getAllTags:u,getData:a,Tags:g,TiffTags:S,GPSTags:f,StringValues:h}}();
;define("upload/main.js",function(o){var n=o("upload/upload.js");new n(second,{url:"/output/upload.php",filekey:"file",outputHeight:500,outputWidth:800,onSuccessUpload:function(o){o=JSON.parse(o),second.style.backgroundImage="url("+o.img+")"},onCancelUpload:function(){},onFailedUpload:function(){}})});
;!function(t,i,s){function e(t,s){this.wrapper="string"==typeof t?i.querySelector(t):t,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0};for(var e in s)this.options[e]=s[e];this.translateZ=this.options.HWCompositing&&o.hasPerspective?" translateZ(0)":"",this.options.useTransition=o.hasTransition&&this.options.useTransition,this.options.useTransform=o.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"==this.options.eventPassthrough?!1:this.options.scrollY,this.options.scrollX="horizontal"==this.options.eventPassthrough?!1:this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?o.ease[this.options.bounceEasing]||o.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}var n=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(i){t.setTimeout(i,1e3/60)},o=function(){function e(t){return r===!1?!1:""===r?t:r+t.charAt(0).toUpperCase()+t.substr(1)}var n={},o=i.createElement("div").style,r=function(){for(var t,i=["t","webkitT","MozT","msT","OT"],s=0,e=i.length;e>s;s++)if(t=i[s]+"ransform",t in o)return i[s].substr(0,i[s].length-1);return!1}();n.getTime=Date.now||function(){return(new Date).getTime()},n.extend=function(t,i){for(var s in i)t[s]=i[s]},n.addEvent=function(t,i,s,e){t.addEventListener(i,s,!!e)},n.removeEvent=function(t,i,s,e){t.removeEventListener(i,s,!!e)},n.prefixPointerEvent=function(i){return t.MSPointerEvent?"MSPointer"+i.charAt(9).toUpperCase()+i.substr(10):i},n.momentum=function(t,i,e,n,o,r){var h,a,l=t-i,c=s.abs(l)/e;return r=void 0===r?6e-4:r,h=t+c*c/(2*r)*(0>l?-1:1),a=c/r,n>h?(h=o?n-o/2.5*(c/8):n,l=s.abs(h-t),a=l/c):h>0&&(h=o?o/2.5*(c/8):0,l=s.abs(t)+h,a=l/c),{destination:s.round(h),duration:a}};var h=e("transform");return n.extend(n,{hasTransform:h!==!1,hasPerspective:e("perspective")in o,hasTouch:"ontouchstart"in t,hasPointer:t.PointerEvent||t.MSPointerEvent,hasTransition:e("transition")in o}),n.isBadAndroid=/Android /.test(t.navigator.appVersion)&&!/Chrome\/\d/.test(t.navigator.appVersion),n.extend(n.style={},{transform:h,transitionTimingFunction:e("transitionTimingFunction"),transitionDuration:e("transitionDuration"),transitionDelay:e("transitionDelay"),transformOrigin:e("transformOrigin")}),n.hasClass=function(t,i){var s=new RegExp("(^|\\s)"+i+"(\\s|$)");return s.test(t.className)},n.addClass=function(t,i){if(!n.hasClass(t,i)){var s=t.className.split(" ");s.push(i),t.className=s.join(" ")}},n.removeClass=function(t,i){if(n.hasClass(t,i)){var s=new RegExp("(^|\\s)"+i+"(\\s|$)","g");t.className=t.className.replace(s," ")}},n.offset=function(t){for(var i=-t.offsetLeft,s=-t.offsetTop;t=t.offsetParent;)i-=t.offsetLeft,s-=t.offsetTop;return{left:i,top:s}},n.preventDefaultException=function(t,i){for(var s in i)if(i[s].test(t[s]))return!0;return!1},n.extend(n.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),n.extend(n.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(t){return t*(2-t)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(t){return s.sqrt(1- --t*t)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(t){var i=4;return(t-=1)*t*((i+1)*t+i)+1}},bounce:{style:"",fn:function(t){return(t/=1)<1/2.75?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},elastic:{style:"",fn:function(t){var i=.22,e=.4;return 0===t?0:1==t?1:e*s.pow(2,-10*t)*s.sin(2*(t-i/4)*s.PI/i)+1}}}),n.tap=function(t,s){var e=i.createEvent("Event");e.initEvent(s,!0,!0),e.pageX=t.pageX,e.pageY=t.pageY,t.target.dispatchEvent(e)},n.click=function(t){var s,e=t.target;/(SELECT|INPUT|TEXTAREA)/i.test(e.tagName)||(s=i.createEvent("MouseEvents"),s.initMouseEvent("click",!0,!0,t.view,1,e.screenX,e.screenY,e.clientX,e.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null),s._constructed=!0,e.dispatchEvent(s))},n}();e.prototype={version:"5.1.3",_init:function(){this._initEvents()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(t){t.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(t){if(!(1!=o.eventType[t.type]&&0!==t.button||!this.enabled||this.initiated&&o.eventType[t.type]!==this.initiated)){!this.options.preventDefault||o.isBadAndroid||o.preventDefaultException(t.target,this.options.preventDefaultException)||t.preventDefault();var i,e=t.touches?t.touches[0]:t;this.initiated=o.eventType[t.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=o.getTime(),this.options.useTransition&&this.isInTransition?(this.isInTransition=!1,i=this.getComputedPosition(),this._translate(s.round(i.x),s.round(i.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=e.pageX,this.pointY=e.pageY,this._execEvent("beforeScrollStart")}},_move:function(t){if(this.enabled&&o.eventType[t.type]===this.initiated){this.options.preventDefault&&t.preventDefault();var i,e,n,r,h=t.touches?t.touches[0]:t,a=h.pageX-this.pointX,l=h.pageY-this.pointY,c=o.getTime();if(this.pointX=h.pageX,this.pointY=h.pageY,this.distX+=a,this.distY+=l,n=s.abs(this.distX),r=s.abs(this.distY),!(c-this.endTime>300&&10>n&&10>r)){if(this.directionLocked||this.options.freeScroll||(this.directionLocked=n>r+this.options.directionLockThreshold?"h":r>=n+this.options.directionLockThreshold?"v":"n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)t.preventDefault();else if("horizontal"==this.options.eventPassthrough)return void(this.initiated=!1);l=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)t.preventDefault();else if("vertical"==this.options.eventPassthrough)return void(this.initiated=!1);a=0}a=this.hasHorizontalScroll?a:0,l=this.hasVerticalScroll?l:0,i=this.x+a,e=this.y+l,(i>0||i<this.maxScrollX)&&(i=this.options.bounce?this.x+a/3:i>0?0:this.maxScrollX),(e>0||e<this.maxScrollY)&&(e=this.options.bounce?this.y+l/3:e>0?0:this.maxScrollY),this.directionX=a>0?-1:0>a?1:0,this.directionY=l>0?-1:0>l?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(i,e),c-this.startTime>300&&(this.startTime=c,this.startX=this.x,this.startY=this.y)}}},_end:function(t){if(this.enabled&&o.eventType[t.type]===this.initiated){this.options.preventDefault&&!o.preventDefaultException(t.target,this.options.preventDefaultException)&&t.preventDefault();var i,e,n=(t.changedTouches?t.changedTouches[0]:t,o.getTime()-this.startTime),r=s.round(this.x),h=s.round(this.y),a=s.abs(r-this.startX),l=s.abs(h-this.startY),c=0,p="";if(this.isInTransition=0,this.initiated=0,this.endTime=o.getTime(),!this.resetPosition(this.options.bounceTime))return this.scrollTo(r,h),this.moved?this._events.flick&&200>n&&100>a&&100>l?void this._execEvent("flick"):(this.options.momentum&&300>n&&(i=this.hasHorizontalScroll?o.momentum(this.x,this.startX,n,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:r,duration:0},e=this.hasVerticalScroll?o.momentum(this.y,this.startY,n,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:h,duration:0},r=i.destination,h=e.destination,c=s.max(i.duration,e.duration),this.isInTransition=1),r!=this.x||h!=this.y?((r>0||r<this.maxScrollX||h>0||h<this.maxScrollY)&&(p=o.ease.quadratic),void this.scrollTo(r,h,c,p)):void this._execEvent("scrollEnd")):(this.options.tap&&o.tap(t,this.options.tap),this.options.click&&o.click(t),void this._execEvent("scrollCancel"))}},_resize:function(){var t=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){t.refresh()},this.options.resizePolling)},resetPosition:function(t){var i=this.x,s=this.y;return t=t||0,!this.hasHorizontalScroll||this.x>0?i=0:this.x<this.maxScrollX&&(i=this.maxScrollX),!this.hasVerticalScroll||this.y>0?s=0:this.y<this.maxScrollY&&(s=this.maxScrollY),i==this.x&&s==this.y?!1:(this.scrollTo(i,s,t,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=o.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(t,i){this._events[t]||(this._events[t]=[]),this._events[t].push(i)},off:function(t,i){if(this._events[t]){var s=this._events[t].indexOf(i);s>-1&&this._events[t].splice(s,1)}},_execEvent:function(t){if(this._events[t]){var i=0,s=this._events[t].length;if(s)for(;s>i;i++)this._events[t][i].apply(this,[].slice.call(arguments,1))}},scrollBy:function(t,i,s,e){t=this.x+t,i=this.y+i,s=s||0,this.scrollTo(t,i,s,e)},scrollTo:function(t,i,s,e){e=e||o.ease.circular,this.isInTransition=this.options.useTransition&&s>0,!s||this.options.useTransition&&e.style?(this._transitionTimingFunction(e.style),this._transitionTime(s),this._translate(t,i)):this._animate(t,i,s,e.fn)},scrollToElement:function(t,i,e,n,r){if(t=t.nodeType?t:this.scroller.querySelector(t)){var h=o.offset(t);h.left-=this.wrapperOffset.left,h.top-=this.wrapperOffset.top,e===!0&&(e=s.round(t.offsetWidth/2-this.wrapper.offsetWidth/2)),n===!0&&(n=s.round(t.offsetHeight/2-this.wrapper.offsetHeight/2)),h.left-=e||0,h.top-=n||0,h.left=h.left>0?0:h.left<this.maxScrollX?this.maxScrollX:h.left,h.top=h.top>0?0:h.top<this.maxScrollY?this.maxScrollY:h.top,i=void 0===i||null===i||"auto"===i?s.max(s.abs(this.x-h.left),s.abs(this.y-h.top)):i,this.scrollTo(h.left,h.top,i,r)}},_transitionTime:function(t){t=t||0,this.scrollerStyle[o.style.transitionDuration]=t+"ms",!t&&o.isBadAndroid&&(this.scrollerStyle[o.style.transitionDuration]="0.001s")},_transitionTimingFunction:function(t){this.scrollerStyle[o.style.transitionTimingFunction]=t},_translate:function(t,i){this.options.useTransform?this.scrollerStyle[o.style.transform]="translate("+t+"px,"+i+"px)"+this.translateZ:(t=s.round(t),i=s.round(i),this.scrollerStyle.left=t+"px",this.scrollerStyle.top=i+"px"),this.x=t,this.y=i},_initEvents:function(i){var s=i?o.removeEvent:o.addEvent,e=this.options.bindToWrapper?this.wrapper:t;s(t,"orientationchange",this),s(t,"resize",this),this.options.click&&s(this.wrapper,"click",this,!0),this.options.disableMouse||(s(this.wrapper,"mousedown",this),s(e,"mousemove",this),s(e,"mousecancel",this),s(e,"mouseup",this)),o.hasPointer&&!this.options.disablePointer&&(s(this.wrapper,o.prefixPointerEvent("pointerdown"),this),s(e,o.prefixPointerEvent("pointermove"),this),s(e,o.prefixPointerEvent("pointercancel"),this),s(e,o.prefixPointerEvent("pointerup"),this)),o.hasTouch&&!this.options.disableTouch&&(s(this.wrapper,"touchstart",this),s(e,"touchmove",this),s(e,"touchcancel",this),s(e,"touchend",this)),s(this.scroller,"transitionend",this),s(this.scroller,"webkitTransitionEnd",this),s(this.scroller,"oTransitionEnd",this),s(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var i,s,e=t.getComputedStyle(this.scroller,null);return this.options.useTransform?(e=e[o.style.transform].split(")")[0].split(", "),i=+(e[12]||e[4]),s=+(e[13]||e[5])):(i=+e.left.replace(/[^-\d.]/g,""),s=+e.top.replace(/[^-\d.]/g,"")),{x:i,y:s}},_animate:function(t,i,s,e){function r(){var u,f,d,m=o.getTime();return m>=p?(h.isAnimating=!1,h._translate(t,i),void(h.resetPosition(h.options.bounceTime)||h._execEvent("scrollEnd"))):(m=(m-c)/s,d=e(m),u=(t-a)*d+a,f=(i-l)*d+l,h._translate(u,f),void(h.isAnimating&&n(r)))}var h=this,a=this.x,l=this.y,c=o.getTime(),p=c+s;this.isAnimating=!0,r()},handleEvent:function(t){switch(t.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(t);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(t);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(t);break;case"keydown":this._key(t);break;case"click":t._constructed||(t.preventDefault(),t.stopPropagation())}}},e.utils=o,"undefined"!=typeof module&&module.exports?module.exports=e:t.IScroll=e}(window,document,Math);
;define("carchoose/main.js",function(){!function(n){function t(){w(),g(),T()}function e(){m()}function i(){window.dd&&window.dd.dialog&&window.dd.dialog.loading("正在加载",2e3)}function a(){window.dd&&window.dd.dialog&&window.dd.dialog.loading("正在加载",100)}function o(){S&&S.height(n(window).height())}function r(){var t=navigator.userAgent;S=n('<div class="choose-cartype-layer" />').prependTo("body"),(/MicroMessenger/.test(t)||!/Android/.test(t))&&S.css("visibility","hidden"),o(),S.append('<section class="choose-brand-layer"><div></div></section>'),S.append('<section class="choose-type-layer"><div></div></section>'),S.append('<section class="choose-color-layer"><div></div></section>'),$=n(".choose-brand-layer").append('<div class="choose-cartype-shortcut"></div>'),M=n(".choose-type-layer"),z=n(".choose-color-layer"),$shortcut=$.find(".choose-cartype-shortcut"),s()}function s(){i(),n.ajax({url:A,dataType:"json",success:function(n){a(),"0"==n.errno&&(d(n.data),S.css("visibility","visible"),m(),c(n.data),u(),f(),h(),l())},error:function(){a()}})}function c(n){var t=[];for(var e in n)t.push(['<div><a href="javascript:void(0);" data-anchor="car-brand-',e,'">',e,"</a></div>"].join(""));$shortcut.html(t.join(""))}function d(n){var t=[];for(var e in n){t.push(['<h3 id="car-brand-'+e+'">',"<div><span>"+e+"</span></div>","</h3>","<ul>"].join(""));for(var i=n[e],a=0;a<i.length;a++)t.push(['<li data-brand-id="'+i[a].brand_id+'">',i[a].name,"</li>"].join(""));t.push("</ul>")}$.find("div").html(t.join("")),k?k.refresh():k=new IScroll($[0],{click:!0,deceleration:_})}function l(){$shortcut.on("click",function(t){var e,i=n(t.target).closest("a");i.length&&(i.addClass("selected"),setTimeout(function(){i.removeClass("selected")},200),e=i.data("anchor"),k.scrollToElement("#"+e,0))})}function u(){$.on("click",function(t){var e,o,r=n(t.target).closest("li");r.length&&r!=F&&(F&&F.removeClass("selected"),F=r,r.addClass("selected"),e=r.data("brand-id"),o=r.text(),Z.brand={id:e,name:o},R[e]?(p(R[e]),y(),T()):(g(),T(),i(),n.ajax({url:E+"?carbrand="+e,dataType:"json",success:function(n){a(),0==n.errno&&(R[e]=n.data,p(n.data),y())},error:function(){a()}})))})}function f(){M.on("click",function(t){var e,o,r,s=n(t.target).closest("li");s.length&&s!=I&&(I&&I.removeClass("selected"),I=s,s.addClass("selected"),e=s.data("brand-type-id"),o=s.text(),r=new RegExp(Z.brand.name.replace(/[\\\|*+?^$]/g,"\\$&"),"g"),Z.type={id:e,shortName:o.replace(r,""),name:o},O?b():(T(),i(),n.ajax({url:L,dataType:"json",success:function(n){a(),0==n.errno&&(O=n.data,v(n.data),b())},error:function(){a()}})))})}function h(){z.on("click",function(e){var i,a,o,r=n(e.target).closest("li");r.length&&(i=r.data("color-id"),a=r.text(),Z.color={id:i,name:a},o=U.subStrg(Z.brand.name,6)+" "+U.subStrg(Z.type.shortName,4)+" "+Z.color.name,N&&N({value:Z,carInfo:o}),t())})}function p(n){for(var t=["<ul>"],e=n,i=0;i<e.length;i++)t.push(['<li data-brand-type-id="'+e[i].brand_type_id+'">',e[i].brand_type_name,"</li>"].join(""));t.push("</ul>"),M.find("div").html(t.join("")),C?C.refresh():C=new IScroll(M[0],{click:!0,deceleration:_})}function v(n){var t=["<ul>"],e=n;for(var i in e)t.push(['<li data-color-id="'+i+'">',e[i].name,"</li>"].join(""));t.push("</ul>"),z.find("div").html(t.join("")),D?D.refresh():D=new IScroll(z[0],{click:!0,deceleration:_})}function m(){$shortcut[0].style.display="block",x(S[0],n(window).width(),0),x(S[0],0,150)}function w(){F&&F.removeClass("selected"),F=null,x(S[0],0,0),x(S[0],n(window).width(),150),$shortcut[0].style.display="none"}function y(){x(M[0],-.66*n(window).width(),150)}function g(){I&&I.removeClass("selected"),I=null,x(M[0],-.66*n(window).width(),0),x(M[0],0,150)}function b(){x(z[0],-.33*n(window).width(),150)}function T(){x(z[0],-.33*n(window).width(),0),x(z[0],0,150)}function x(n,t,e,i,a){var o=n&&n.style,r="",s="";if(i||(i="linear"),a||(a=0),o){if("[object Array]"===Object.prototype.toString.call(t))switch(t.length){case 3:r=s="translate3d("+t[0]+"px,"+t[1]+"px,"+t[2]+"px)";break;case 2:r=s="translate("+t[0]+"px,"+t[1]+"px)translateZ(0)";break;case 1:r="translate("+t[0]+"px,0)translateZ(0)",s="translateX("+t[0]+"px)";break;default:r="translate("+t[0]+"px,0)translateZ(0)",s="translateX("+t[0]+"px)"}else{if(isNaN(parseInt(t)))return;r="translate("+t+"px,0)translateZ(0)",s="translateX("+t+"px)"}o.webkitTransitionDuration=o.MozTransitionDuration=o.msTransitionDuration=o.OTransitionDuration=o.transitionDuration=e+"ms",o.webkitTransitionTimingFunction=o.MozTransitionTimingFunction=o.msTransitionTimingFunction=o.OTransitionTimingFunction=o.transitionTimingFunction=i,o.webkitTransitionDelay=o.MozTransitionDelay=o.msTransitionDelay=o.OTransitionDelay=o.transitionDelay=a+"ms",o.webkitTransform=r,o.msTransform=o.MozTransform=o.OTransform=s}}function j(n){return document.activeElement&&document.activeElement.blur(),S?void setTimeout(function(){e()},300):(n=n||{},A=n.brandsURL||"/pinche/cartype/getcarbrand",E=n.typesURL||"/pinche/cartype/getcartype",L=n.colorsURL||"/pinche/cartype/getcolor",N=n.onselect||function(){},void r())}var k,C,D,S,$,M,z,F,I,O,Z,_,A,E,L,N,R={};_=.002,Z={brand:{},type:{},color:{}},n(window).on("resize",function(){o()});var U=function(){var n=function(n){return n.replace(/[^\x00-\xff]/g,"**").length},t=function(t,e){if(null==t)return"";if(n(t)>e){for(var i,a=0,o="",r=0;r<t.length;r++)if(i=t.charAt(r),a+=n(i),a>=e){o=t.substring(0,r+1);break}return o+="..."}return t};return{LenB:n,subStrg:t}}();n.didiCarChoose=function(n){j(n)}}(Zepto)});