define("ddplayer/player/didiPlayer.js",function(i,t,e){"use strict";i("ddplayer/player/events.js"),i("ddplayer/player/controls.js"),i("ddplayer/player/update.js"),i("ddplayer/player/poster.js"),i("ddplayer/player/message.js"),i("ddplayer/player/videoList.js"),i("ddplayer/player/exception.js");var s=i("ddplayer/base/vars.js"),d=i("ddplayer/base/console.js"),r=i("ddplayer/player/mediaPlayer.js"),a=i("ddplayer/player/html5UI.js"),o=i("ddplayer/player/settings.js"),l=i("ddplayer/player/errorTypes.js");r.prototype._init=function(i){this._hideMainCtrlTime=null,this._firstLoadFlag=!0,this._dataTimeout=5e3,this._showRecommendFlag=!1,this._sendVVFlag=!1,this.config=o.initConfig(i),this._sendPlayDisplayCompleteFlag=!1},r.prototype.htmlTo=function(i){if(i=$(i),i.length>0){var t=this;if(this.$parentDom=i,$.isUndefined(this.$player)){ddvp.debug.playerLoadDomStartTime=Date.now(),i.html(a.makeLoadingTmpl(this.config)),d.log("加载loading完成, 耗时--->"+(Date.now()-ddvp.debug.playerLoadDomStartTime)/1e3),this.$player=$("#"+this.config.mainId),this.$playerLoading=$("#"+this.config.mainId+" .ddvp_player_loading"),this._getDataFlag=!1;var e=this.config.data;if($.isUndefined(e))t._showMsg({text:l.PROCESS[202]});else if($.isUndefined(e.vidList)&&$.isUndefined(e.videoDataList)){var s={videoDataList:[e]};this.videoList=this._videoList(s),this.updateMedia(e)}else{var r,o=this.videoList=this._videoList(e);try{r="vidList"===o.type?{vid:o.vidList[o.curIndex],site:o.site}:o.videoDataList[o.curIndex]}catch(n){t._showMsg({text:l.PROCESS[204]})}this.updateMedia(r)}}else this.$parentDom.html(this.$main),this.cache.autoplay&&this._playOrPause("play")}},r.prototype._initDoms=function(){var i="#"+this.config.mainId;this.$main=$(i),this.$loading=$(i+" .ddvp_player_loading"),this.$loadingDesc=$(i+" .ddvp_player_loading_notice"),this.$video=$(i+" #"+this.config.elemId),this.videoTag=$(i+" #"+this.config.elemId)[0],this.$titleCon=$(i+" .ddvp_title"),this.$title=$(i+" .ddvp_title_content"),this.$posterCon=$(i+" .ddvp_poster"),this.$posterRight=$(i+" .ddvp_poster_right"),this.$mid=$(i+" .ddvp_mid"),this.$midPlay=$(i+" .ddvp_mid_play"),this.$midRewindForwardCon=$(i+" .ddvp_mid_rewind_forward"),this.$midTime=$(i+" .ddvp_mid_time"),this.$midModeListCon=$(i+" .ddvp_mid_mode"),this.$mideCurModeBtn=$(i+" .ddvp_mid_cur_mode_btn"),this.$midCurMode=$(i+" .ddvp_mid_cur_mode"),this.$midModeList=$(i+" .ddvp_mid_mod_list"),this.$midModeLi=$(i+" .ddvp_mid_mod_list li"),this.$ctrlCon=$(i+" .ddvp_ctrl"),this.$ctrlBar=$(i+" .ddvp_ctrl_bar"),this.$ctrlPlay=$(i+" .ddvp_ctrl_play"),this.$ctrlPause=$(i+" .ddvp_ctrl_pause"),this.$ctrlBuffer=$(i+" .ddvp_ctrl_buffer"),this.$ctrlPointsCon=$(i+" .ddvp_ctrl_points"),this.$ctrlCurPlayedBar=$(i+" .ddvp_ctrl_played_bar"),this.$ctrlTime=$(i+" .ddvp_ctrl_time"),this.$ctrlCurTime=$(i+" .ddvp_ctrl_cur_time"),this.$ctrlDuration=$(i+" .ddvp_ctrl_duration"),this.$ctrlDragAnchor=$(i+" .ddvp_ctrl_drag_anchor"),this.$ctrlTrackBar=$(i+" .ddvp_ctrl_track_bar"),this.$ctrlScreen=$(i+" .ddvp_ctrl_screen"),this.$ctrlFullScreen=$(i+" .ddvp_ctrl_full_screen"),this.$ctrlShrinkScreen=$(i+" .ddvp_ctrl_shrink_screen"),this.$maskLayer=$(i+" .ddvp_mask_layer")},r.prototype._playOrPause=function(i){var t=this;ddvp.debug.playerPlayStartTime=Date.now(),clearTimeout(this._hideMainCtrlTime),"pause"===i?(this._pause(),s.IsNewWindowsPhone?setTimeout(function(){t._showPlayBtn()},300):this._showPlayBtn(),this._showMainCtrl()):(!this._sendVVFlag&&(s.IsBaiduBrowser||s.IsBaiduBoxApp||s.IsIOS&&(s.IsQQBrowser||s.IsUCBrowser))&&(d.log("统计: vv"),this._sendVVFlag=!0),!this._sendRealVVFlag&&((/QQBrowser\/5\./i.test(s.UA)||s.IsUCBrowser)&&s.IsIOS||($.isUndefined(this.adv)||this.adv.isMediaPlayed)&&s.IsBaiduBoxApp)&&(d.log("统计: reallvv"),this._sendRealVVFlag=!0),(s.IsUCBrowser||s.IsQQBrowser)&&this.$video.oriShow(),(/UCBrowser\/9\./i.test(s.UA)||s.IsSonyPhone||s.IsVivoPhone||s.IsUCBrowser)&&s.IsAndroid?setTimeout(function(){t._play()},50):s.IsWindowsPhone?setTimeout(function(){t._play()},300):!this._firstLoadFlag&&s.IsIOS&&s.IsQQBrowser?setTimeout(function(){t._play()},50):this._play(),this._startPlayTime=$.now(),this._hideMainCtrlTime=setTimeout(function(){t._hideMainCtrl()},3e3),this._firstLoadFlag?(s.IsIphone||s.IsBaiduBrowser||!this.cache.autoplay||(this.$midPlay.oriShow(),this._showPlayBtn(),this.showPoster()),this._showLoading(),this._firstLoadFlag=!1):s.IsBaiduBrowser?this._hideLoading():this._showLoading(),s.IsOldWindowsPhone||s.IsBaiduBrowser,s.IsIphone&&(s.IsUCBrowser||s.IsQQBrowser||s.IsWeiXinBrowser||s.IsDiDiBrowser)&&this._showMainCtrl())},r.prototype._autoNextVideoService=function(){var i=this;i.config.isShowRecommend&&(i._showRecommendFlag=!0,this.on("ended",function(){setTimeout(function(){if(i._showRecommendFlag){d.log("显示相关推荐");var t=i.videoList,e=t.curIndex,s=null;"vidList"===t.type&&e<t.vidList.length-1?(t.curIndex++,s={vid:t.vidList[t.curIndex],site:t.site}):"videoDataList"===t.type&&e<t.videoDataList.length-1&&(t.curIndex++,s=t.videoDataList[t.curIndex]),d.log("nextVideo"+s),null!==s?i.updateMedia(s,!0):(d.log("showRecommend 11"),i.showRecommend())}},800)}))},e.exports=r});