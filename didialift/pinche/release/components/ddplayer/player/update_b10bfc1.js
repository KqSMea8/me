define("ddplayer/player/update.js",function(e){"use strict";var a=e("ddplayer/player/mediaPlayer.js"),i=e("ddplayer/base/vars.js"),t=e("ddplayer/player/loadCacheData.js"),d=e("ddplayer/base/special.js"),o=e("ddplayer/player/html5UI.js"),s=e("ddplayer/player/errorTypes.js"),r=e("ddplayer/base/console.js"),n=e("ddplayer/player/settings.js"),l=function(e){var a="error";if(!$.isUndefined(e)&&null!==e)if($.isUndefined(e.urls)||$.isUndefined(e.durations))$.isUndefined(e.vid)&&$.isUndefined(e.liveId)?$.isUndefined(e.src)||(a="source"):a="partial";else try{var t=i.IsIphone||i.IsQQBrowser?"m3u8":"mp4";t=d.isDiDiForceUseMp4()?"mp4":t,a="whole";for(var o in e.urls[t])e.durations[o].length!==e.urls[t][o].length&&(a="partial")}catch(s){a="partial"}return a},c=function(e){var a=e.cache;!$.isUndefined(e.adv)&&$.isFunction(e.adv.hideMediaView)&&e.adv.hideMediaView(),e.$title.html(a.title),document.title=a.title,e.$ctrlCurTime.html($.formatSeconds(0)),e.$ctrlDuration.html($.formatSeconds(a.duration)),e.$ctrlCurPlayedBar.css({width:0}),e.changePoster({url:a.poster})},p=function(e,a){if(e.trigger("loadedvideodata"),"videoDataList"===e.videoList.type){var d=e.videoList.videoDataList[e.videoList.curIndex];a.timeLimit=d.timeLimit||"0"}if(window.videoData=a,e.cache=new t(e.config,a),e.videoData=$.extend({},a),e._firstLoadFlag){if(e.$player.append(o.makeVideoTmpl(e.cache)),r.log("加载dom完成, 耗时--->"+(Date.now()-ddvp.debug.playerLoadDomStartTime)/1e3),e._initDoms(),"noSupport"===e.$video.attr("data-nosupport")){var n=s.SUPPORT[300];return void e._showMsg({text:n,btns:{btnA:{text:"暂时无法播放"}}})}e._loadedDomFlag=!0,e._initEvent(),e._initControls(),e._initException(),e._autoNextVideoService(),e.$loadingDesc.oriHide(),e.$video.length>0&&(e.videoTag.volume=e.config.volume,e.$ctrlDuration.html($.formatSeconds(e.cache.duration)))}else c(e);e.setSrc(e.cache.curPlayUrl),e.duration=e.cache.duration,e.currentTime=0,e._hideLoading(),e.cache.autoplay?(e.$midPlay.oriHide(),e._sendVVFlag||(r.log("统计: vv"),e._sendVVFlag=!0),e._playOrPause("play")):(e._playOrPause("pause"),e._hideMainCtrl(),e._showMidPlayBtn(),e.showPoster(),(i.IsUCBrowser||i.IsQQBrowser&&!/QQBrowser\/4\.2/i.test(i.UA))&&e.$video.oriHide()),e._firstLoadFlag,r.log("播放器加载时间:"+(Date.now()-ddvp.debug.playerLoadStartTime)/1e3+"秒"),e._sendPlayDisplayCompleteFlag||(r.log("发送行为统计点:(play_display_complete)"),e._sendPlayDisplayCompleteFlag=!0)};a.prototype.updateMedia=function(e,a){var t=this;if(!$.isUndefined(e)){var d=l(e);if("error"!==d){if(null!==t.videoData&&(t.hideRecommend(),t.config.isShowRecommend&&"source"===d&&t.videoData.video_src.indexOf(e.src)>-1))return void(t._showRecommendFlag=!0);t._showRecommendFlag=!1,t._firstLoadFlag||(ddvp.debug.playerLoadStartTime=Date.now(),this._sendRealVVFlag&&!this._sendEndFlag&&(r.log("统计: ended"),this._sendEndFlag=!0),$.isUndefined(this.videoData)||(this.config.data=this.videoData,this.config.dataType="video_data"),this._sendVVFlag=!1,this._sendRealVVFlag=!1,this._sendStartFlag=!1,this._sendEndFlag=!1,this._playByHistoryFlag=!1,this._timeoutFlag=!1,$.isUndefined(this.config)&&(this.config=n.initConfig({})),e=$.extend({},e),"undefined"!=typeof a&&(this.config.autoplay=a),this._playOrPause("pause"),i.IsBaiduBrowser||this._showLoading()),"partial"===d||"source"===d?(this._getDataFlag=!1,setTimeout(function(){t._getDataFlag||(t._timeoutFlag=!0,t._showMsg({text:s.REQUEST[400],btns:{btnA:{text:"刷新",callback:function(){t._timeoutFlag=!1,t._hideMsg(),t.updateMedia(e,a)}}}}))},this._dataTimeout),ddvp.debug.playerLoadMediaDataStartTime=Date.now()):p(t,e)}else t._showMsg({text:s.PROCESS[202]})}}});