define("ddplayer/player/events.js",function(e){"use strict";{var n=e("ddplayer/player/mediaPlayer.js"),t=e("ddplayer/base/vars.js"),o=e("ddplayer/base/special.js");e("ddplayer/base/console.js")}n.prototype.on=function(e,n){var t=this;this._onDomLoaded(function(){"ended"===e||"onended"===e?t.eventProcess.userEnded.push({name:"ended",process:function(){n.call(t)}}):t.$video.on(e,function(e){n.call(t,e)})})},n.prototype.off=function(e,n){var t=this;this._onDomLoaded(function(){e=e.toLowerCase(),t.$video.off(e,n)})},n.prototype.trigger=function(e){var n=this;this._onDomLoaded(function(){e=e.toLowerCase(),n.$video.trigger(e)})},n.prototype.one=function(e,n){var t=this;this._onDomLoaded(function(){e=e.toLowerCase(),"ended"===e?this.$video.on(e,function(){t.cache.curIndex===t.cache.totCounts-1&&t.$video.one(e,function(e){n.call(t,e)})}):this.$video.one(e,function(e){n.call(t,e)})})},n.prototype._addEvent=function(e,n,t){var i=this.eventProcess,s=this;if(e=e.toLowerCase(),!$.isUndefined(e)&&!$.isUndefined(i[e])){var r={},d=o.isAllowTimeupdateReplaceEnded()&&("ended"===e||"onended"===e);$.isFunction(n)?(d?(e="timeupdate",r.process=function(){s.videoTag.duration-s.videoTag.currentTime<.5&&n.call(s)}):r.process=function(){n.call(s)},r.name="_"+e+(new Date).getTime(),i[e].push(r)):$.isString(n)&&$.isFunction(t)&&(r.process=d?function(){s.videoTag.duration-s.videoTag.currentTime<.5&&t.call(s)}:function(){t.call(s)},r.name=n,i[e].push(r))}},n.prototype._removeEvent=function(e,n){var t=this.eventProcess;$.isUndefined(e)||$.isUndefined(t[e])||($.isUndefined(n)?t[e]=[]:$.isString(n)&&$.each(t[e],function(o,i){i.name===n&&t[e].splice(o,1)}))},n.prototype._fireEvent=function(e){var n=this.eventProcess,t=this;$.isUndefined(e)||$.isUndefined(n[e])||$.each(n[e],function(e,n){n.process.call(t)})},n.prototype._onBaseEnded=function(){var e=this,n=e.cache;if(this._startPlayTime=$.now(),this._bufferCount=0,-1===n.curIndex&&(n.curIndex=0),t.IsBaiduBrowser||t.IsBaiduBoxApp){var o=n.srcList[n.modeType],i=0;$.each(o,function(e,t){return i+=t.duration,e>=n.curIndex?!1:void 0})}var s=n.getNextUrl();if(""!==s)this.trigger("waiting"),n.curPlayUrl=s,n.curIndex++,this.setSrc(n.curPlayUrl),setTimeout(function(){e.videoTag.play()},100),this.videoData.video_src=s;else{if(n.loop){this.trigger("waiting");var r=n.getFirstUrl();this.setSrc(r),this.play(),n.curPlayUrl=r,n.curIndex=-1,this.videoData.video_src=r}else n.curPlayUrl=s;$.each(this.eventProcess.userEnded,function(e,n){n.process()})}this._nextPreLoadImg=null},n.prototype._onKeyDown=function(e,n){var t=e.keyCode||e.which||e.charCode,o=function(e){var t=n.getVolume();t+=e,n.setVolume(t)};if(!$.isUndefined(t))switch(t){case 38:o(.1);break;case 40:o(-.1);break;case 37:n.seekTo(n.currentTime-10);break;case 39:n.seekTo(n.currentTime+10)}},n.prototype._initEvent=function(){var e=this,n=this.eventProcess;this.$video&&this.$video.length>0&&$.each(e.eventList,function(o,i){$.isArray(n[i])&&(t.IsSAMSUNGNote3&&"ended"!==i||!t.IsSAMSUNGNote3)&&e.$video.on(i,function(t){$(e.$video,e.$main).length>0&&$.each(n[i],function(n,o){o.process.call(e,t)})})}),this._addEvent("ended",this._onBaseEnded),$("body").on("keydown",function(n){e._onKeyDown(n,e)})}});